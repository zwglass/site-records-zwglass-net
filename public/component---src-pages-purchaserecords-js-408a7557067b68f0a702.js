(self.webpackChunkzwglass_purchase_records=self.webpackChunkzwglass_purchase_records||[]).push([[7515],{52495:function(e,t,n){"use strict";n.d(t,{s:function(){return l}});var r=n(50008),a=n.n(r);function o(e,t){"function"==typeof e?e(t):"object"===a()(e)&&e&&"current"in e&&(e.current=t)}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){o(t,e)}))}}},45241:function(e,t,n){"use strict";var r=n(22122),a=n(17375),o=n(96156),l=n(6610),c=n(5991),s=n(10379),i=n(46070),u=n(77608),d=n(67294),m=n(75900),p=n.n(m);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var a=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var g=function(e){(0,s.Z)(n,e);var t=_(n);function n(e){var r;(0,l.Z)(this,n),(r=t.call(this,e)).handleChange=function(e){var t=r.props,n=t.disabled,a=t.onChange;n||("checked"in r.props||r.setState({checked:e.target.checked}),a&&a({target:v(v({},r.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},r.saveInput=function(e){r.input=e};var a="checked"in e?e.checked:e.defaultChecked;return r.state={checked:a},r}return(0,c.Z)(n,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,l=t.className,c=t.style,s=t.name,i=t.id,u=t.type,m=t.disabled,f=t.readOnly,v=t.tabIndex,_=t.onClick,g=t.onFocus,h=t.onBlur,b=t.autoFocus,y=t.value,E=t.required,C=(0,a.Z)(t,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","autoFocus","value","required"]),O=Object.keys(C).reduce((function(e,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(e[t]=C[t]),e}),{}),Z=this.state.checked,S=p()(n,l,(e={},(0,o.Z)(e,"".concat(n,"-checked"),Z),(0,o.Z)(e,"".concat(n,"-disabled"),m),e));return d.createElement("span",{className:S,style:c},d.createElement("input",(0,r.Z)({name:s,id:i,type:u,required:E,readOnly:f,disabled:m,tabIndex:v,className:"".concat(n,"-input"),checked:!!Z,onClick:_,onFocus:g,onBlur:h,onChange:this.handleChange,autoFocus:b,ref:this.saveInput,value:y},O)),d.createElement("span",{className:"".concat(n,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"checked"in e?v(v({},t),{},{checked:e.checked}):null}}]),n}(d.Component);g.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){}},t.Z=g},83123:function(e,t,n){"use strict";var r=n(67294),a=n(54325),o=function(e){var t=e.spinning,n=(0,r.useState)(!1),o=n[0],l=n[1],c={display:o?"block":"none"};return(0,r.useEffect)((function(){l(t)}),[t]),r.createElement("div",{className:"overall-loading",style:c},r.createElement(a.Z,{spinning:t,size:"large"}))};o.defaultProps={spinning:!1},t.Z=o},21989:function(e,t,n){"use strict";n.d(t,{v:function(){return a}});var r=n(67294),a=function(e){var t=e.visible,n=(0,r.useState)(0),a=n[0],o=n[1];return(0,r.useEffect)((function(){if(t>0){var e="undefined"!=typeof document?document.documentElement.scrollTop||document.body.scrollTop:0;o(e)}var n;0===t&&(n=a,"undefined"!=typeof window&&setTimeout((function(){window.scrollTo({top:parseInt(n),behavior:"smooth"})}),500))}),[t]),r.createElement(r.Fragment,null)};a.defaultProps={visible:0}},86040:function(e,t,n){"use strict";n.d(t,{d:function(){return d},Y:function(){return m}});var r=n(85061),a=n(67294),o=n(40977),l=n(94789),c=n(93299),s=n(75334),i=n(32210),u=n(24274),d=function(e){var t=e.visible,n=e.setVisible,d=e.visibleNum,m=e.uploadedHandle,p=(0,a.useState)([]),f=p[0],v=p[1],_=(0,a.useState)(""),g=_[0],h=_[1],b=(0,a.useState)(!1),y=b[0],E=b[1],C={onRemove:function(e){var t=[].concat(f),n=t.indexOf(e);t.splice(n,1),v(t),console.log(t)},onChange:function(e){var t=(0,r.Z)(e.fileList),n=[];t.map((function(e){n.push(e.originFileObj)})),v(n)},beforeUpload:function(e){return!1},filesList:[]};return a.createElement(l.Z,{visible:t===d,title:"上传淘宝订单CSV文件",closable:!1,footer:[a.createElement(c.Z,{key:"upload_csv",onClick:function(){if(h(""),2===f.length){var e=new FormData,t=1;return f.forEach((function(n){e.append("file"+t,n),t+=1})),E(!0),new Promise((function(t,r){(0,u.H)("records-admin/v1/taobaopurchaserecord","post",{},e).then((function(e){console.log(e),e.code&&1e3===e.code?(o.ZP.success("淘宝订单 CSV 文件上传成功!"),n(0),t(!0)):(o.ZP.error("淘宝订单 CSV 文件上传失败..."),r(!1)),E(!1),m()})).catch((function(e){o.ZP.error("淘宝订单 CSV 文件上传失败, 请检查网络或文件..."),console.log(e),r(!1),E(!1)}))}))}h("必须选择淘宝 订单、商品 2个csv文件")},loading:y},"上传"),a.createElement(c.Z,{key:"cancel_modal",onClick:function(){n(0)},loading:y},"取消")]},a.createElement(s.Z,Object.assign({},C,{maxCount:2,multiple:!0,accept:".csv"}),a.createElement(c.Z,{icon:a.createElement(i.Z,null)},"Select Csv File")),g.length>0?a.createElement("div",null,a.createElement("br",null),a.createElement("p",{style:{color:"red"}},"* ",g)):null)};d.defaultProps={visible:0,setVisible:function(e){return console.log(e)},visibleNum:1,uploadedHandle:function(){return console.log("Uploaded")}};var m=function(e){var t=e.visible,n=e.setVisible,d=e.visibleNum,m=e.uploadedHandle,p=(0,a.useState)([]),f=p[0],v=p[1],_=(0,a.useState)(""),g=_[0],h=_[1],b=(0,a.useState)(!1),y=b[0],E=b[1],C={onRemove:function(e){var t=[].concat(f),n=t.indexOf(e);t.splice(n,1),v(t),console.log(t)},onChange:function(e){var t=(0,r.Z)(e.fileList),n=[];t.map((function(e){n.push(e.originFileObj)})),v(n)},beforeUpload:function(e){return!1},filesList:[]};return a.createElement(l.Z,{visible:t===d,title:"上传淘宝订单CSV文件",closable:!1,footer:[a.createElement(c.Z,{key:"upload_csv",onClick:function(){if(h(""),2===f.length){var e=new FormData,t=1;return f.forEach((function(n){e.append("file"+t,n),t+=1})),E(!0),new Promise((function(t,r){(0,u.H)("records-admin/v1/inittaobaopurchaserecord","post",{},e,2e5).then((function(e){console.log(e),e.code&&1e3===e.code?(o.ZP.success("初始化批量上传淘宝订单 CSV 文件成功!"),n(0),t(!0)):(o.ZP.error("淘宝订单 CSV 文件上传失败..."),r(!1)),E(!1),m()})).catch((function(e){o.ZP.error("淘宝订单 CSV 文件上传失败, 请检查网络或文件..."),console.log(e),r(!1),E(!1)}))}))}h("必须选择淘宝 订单、商品 2个csv文件")},loading:y},"上传"),a.createElement(c.Z,{key:"cancel_modal",onClick:function(){n(0)},loading:y},"取消")]},a.createElement(s.Z,Object.assign({},C,{maxCount:2,multiple:!0,accept:".csv"}),a.createElement(c.Z,{icon:a.createElement(i.Z,null)},"Select Csv File")),g.length>0?a.createElement("div",null,a.createElement("br",null),a.createElement("p",{style:{color:"red"}},"* ",g)):null)};m.defaultProps={visible:0,setVisible:function(e){return console.log(e)},visibleNum:1,uploadedHandle:function(){return console.log("Uploaded")}}},75045:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Dt}});var r=n(67294),a=n(93696),o=n(23148),l=n(56452),c=n(77371),s=n(90579),i=n(93299),u=n(30165),d=n(24856),m=n(92137),p=n(87757),f=n.n(p),v=n(27188),_=n(40977),g={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},h=n(12112),b=function(e,t){return r.createElement(h.Z,Object.assign({},e,{ref:t,icon:g}))};b.displayName="RedoOutlined";var y,E=r.forwardRef(b),C=n(61415),O=function(){return new Promise((function(e,t){var n=!1;if("undefined"!=typeof document&&(n="complete"===document.readyState),n)if(y=(0,C.Z)()){for(var r=y.GET_PRINTER_COUNT(),a=[],o=0;o<r;o++)a.push(y.GET_PRINTER_NAME(o));e(a)}else _.ZP.error("连接打印服务器失败..."),t("LODOP server connect error...");else _.ZP.error("请等待页面加载完成, 再刷新打印机..."),t("LODOP server connecting...")}))},Z=n(48428),S=n(5321),k=n(33328),x=n(24274),j=["printer-admin/v1/defaultprinter"],P=n(21599),R=v.Z.Option,D=function(e){var t=e.onChange,n=e.purchaseRecordsList,a=e.hasAllPrintCount,o=e.setHasAllPrintCount,l=(0,r.useState)(null),u=l[0],d=l[1],p=(0,r.useRef)(""),g=(0,r.useState)([]),h=g[0],b=g[1],y=(0,r.useState)([]),C=y[0],k=y[1],D=function(){(0,S.T)(),O().then(function(){var e=(0,m.Z)(f().mark((function e(t){var n,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],r=0;r<t.length;r++)n.push({label:t[r],value:r});b(n),_.ZP.info("打印机列表刷新成功!");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),b([])}))};(0,r.useEffect)((function(){"undefined"!=typeof document&&"complete"===document.readyState?D():_.ZP.info("请网页加载完成后刷新打印机!!!")}),[]),(0,r.useEffect)((function(){var e,t=Z.Z.pagesName.purchaseRecords;(e=t,new Promise((function(t,n){var r=[].concat(j)[0];(0,x.H)(r,"get",{},{}).then((function(r){if(Object.keys(r).includes("results")&&r.results.length>0){for(var a=r.results,o=0;o<a.length;o++){var l=a[o];if(l.page_name===e)return void t(l.printer_name)}n("None default printer...")}else n("Error network...")})).catch((function(e){console.log(e),n(e)}))}))).then((function(e){e&&h.length>0&&w(function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.label===t)return r.value}return null}(h,e))})).catch((function(e){return console.log(e)}))}),[h]),(0,r.useEffect)((function(){k(function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.has_print||t.push(r)}return console.log(t),t}(n))}),[n]);var w=function(e){console.log(e),d(e),h.length>e&&h[e]instanceof Object&&Object.keys(h[e]).includes("label")&&(p.current=h[e].label),t(e)},H=function(e){o(a+1)};return r.createElement("div",{style:{width:"100%",height:"auto",margin:"10px 2px"}},r.createElement(c.Z,null,r.createElement(v.Z,{placeholder:"请选择打印机",onChange:w,value:u,style:{minWidth:120,maxWidth:220}},h.map((function(e,t){return r.createElement(R,{key:t.toString(),value:e.value},e.label)}))),r.createElement(i.Z,{disabled:C.length<1,onClick:function(){var e,t={page_name:Z.Z.pagesName.purchaseRecords,printer_name:p.current};(e=t,new Promise((function(t,n){var r=[].concat(j)[0];(0,x.H)(r,"post",{},e).then((function(e){t(e)})).catch((function(e){console.log(e),n(e)}))}))).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),(0,P.Y)(C,u,H)},type:"primary"},"打印(未打印)"),r.createElement(s.Z,{title:"刷新打印机"},r.createElement(i.Z,{shape:"circle",icon:r.createElement(E,null),onClick:D}))))};D.defaultProps={onChange:function(e){return console.log(e)},purchaseRecordsList:[],hasAllPrintCount:0,setHasAllPrintCount:function(e){return console.log(e)}};var w=n(94789),H=n(16306),q=n(89065),L=function(e){var t=e.modalState,n=e.setModalState,a=e.selectCustomerHandle;e.clickCreatedCustomerHandle;return r.createElement(r.Fragment,null,r.createElement(w.Z,{visible:t,title:"选择顾客",closable:!1,footer:[r.createElement(i.Z,{key:"back",onClick:function(){n(!1)}},"取消")]},r.createElement(q.Z,{selectButtonOnClick:a})))};L.defaultProps={modalState:!1,setModalState:function(e){return console.log(e)},selectCustomerHandle:function(e){console.log(e)},clickCreatedCustomerHandle:function(e){console.log(e)}};var I=n(28130),A=n(59713),N=n.n(A),F=n(67154),M=n.n(F),T=n(45241),V=n(75900),K=n.n(V),B=n(82525),Y=r.createContext(null),U=Y.Provider,$=Y,z=n(52495),G=n(16654),W=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},X=function(e,t){var n,a=r.useContext($),o=r.useContext(B.E_),l=o.getPrefixCls,c=o.direction,s=r.useRef(),i=(0,z.s)(t,s);r.useEffect((function(){(0,G.Z)(!("optionType"in e),"Radio","`optionType` is only support in Radio.Group.")}),[]);var u=e.prefixCls,d=e.className,m=e.children,p=e.style,f=W(e,["prefixCls","className","children","style"]),v=l("radio",u),_=M()({},f);a&&(_.name=a.name,_.onChange=function(t){e.onChange&&e.onChange(t),(null==a?void 0:a.onChange)&&a.onChange(t)},_.checked=e.value===a.value,_.disabled=e.disabled||a.disabled);var g=K()("".concat(v,"-wrapper"),(n={},N()(n,"".concat(v,"-wrapper-checked"),_.checked),N()(n,"".concat(v,"-wrapper-disabled"),_.disabled),N()(n,"".concat(v,"-wrapper-rtl"),"rtl"===c),n),d);return r.createElement("label",{className:g,style:p,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},r.createElement(T.Z,M()({},_,{prefixCls:v,ref:i})),void 0!==m?r.createElement("span",null,m):null)},Q=r.forwardRef(X);Q.displayName="Radio",Q.defaultProps={type:"radio"};var J=Q,ee=n(63038),te=n.n(ee);function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(r=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ae=n(82226),oe=r.forwardRef((function(e,t){var n=r.useContext(B.E_),a=n.getPrefixCls,o=n.direction,l=r.useContext(ae.Z),c=function(e,t){var n=t||{},a=n.defaultValue,o=n.value,l=n.onChange,c=n.postState,s=ne(r.useState((function(){return void 0!==o?o:void 0!==a?"function"==typeof a?a():a:"function"==typeof e?e():e})),2),i=s[0],u=s[1],d=void 0!==o?o:i;c&&(d=c(d));var m=r.useRef(!0);return r.useEffect((function(){m.current?m.current=!1:void 0===o&&u(o)}),[o]),[d,function(e){u(e),d!==e&&l&&l(e,d)}]}(e.defaultValue,{value:e.value}),s=te()(c,2),i=s[0],u=s[1];return r.createElement(U,{value:{onChange:function(t){var n=i,r=t.target.value;"value"in e||u(r);var a=e.onChange;a&&r!==n&&a(t)},value:i,disabled:e.disabled,name:e.name}},function(){var n,c=e.prefixCls,s=e.className,u=void 0===s?"":s,d=e.options,m=e.optionType,p=e.buttonStyle,f=e.disabled,v=e.children,_=e.size,g=e.style,h=e.id,b=e.onMouseEnter,y=e.onMouseLeave,E=a("radio",c),C="".concat(E,"-group"),O=v;if(d&&d.length>0){var Z="button"===m?"".concat(E,"-button"):E;O=d.map((function(e){return"string"==typeof e?r.createElement(J,{key:e,prefixCls:Z,disabled:f,value:e,checked:i===e},e):r.createElement(J,{key:"radio-group-value-options-".concat(e.value),prefixCls:Z,disabled:e.disabled||f,value:e.value,checked:i===e.value,style:e.style},e.label)}))}var S=_||l,k=K()(C,"".concat(C,"-").concat(p),(n={},N()(n,"".concat(C,"-").concat(S),S),N()(n,"".concat(C,"-rtl"),"rtl"===o),n),u);return r.createElement("div",{className:k,style:g,onMouseEnter:b,onMouseLeave:y,id:h,ref:t},O)}())}));oe.defaultProps={buttonStyle:"outline"};var le=r.memo(oe),ce=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},se=function(e,t){var n=r.useContext($),a=r.useContext(B.E_).getPrefixCls,o=e.prefixCls,l=ce(e,["prefixCls"]),c=a("radio-button",o);return n&&(l.checked=e.value===n.value,l.disabled=e.disabled||n.disabled),r.createElement(J,M()({prefixCls:c},l,{type:"radio",ref:t}))},ie=r.forwardRef(se),ue=J;ue.Button=ie,ue.Group=le;var de=ue,me=n(65451),pe=n(23796),fe=v.Z.Option,ve={width:180},_e={1:["negative","negative"],2:["negative","positive"],3:["positive","negative"],4:["positive","positive"]},ge=function(e){var t=null,n=null,r=null,a=null;if(!e)return{sph:t,cyl:n,axi:r,add:a};var o=e.replace(/(^\s*)|(\s*$)/g,"");if(o.indexOf("ADD")>1){var l=o.split("ADD");a=l[1].replace(/(^\s*)|(\s*$)/g,"").replace(":",""),o=l[0].replace(/(^\s*)|(\s*$)/g,"")}if(o.length>0)if(o.indexOf("-",4)>5){t=o.slice(0,o.indexOf("-",4)).replace(/(^\s*)|(\s*$)/g,"");var c=o.slice(o.indexOf("-",4)).split("*");n=c[0].replace(/(^\s*)|(\s*$)/g,""),r=parseInt(c[1].replace(/(^\s*)|(\s*$)/g,""))}else t=o.replace(/(^\s*)|(\s*$)/g,"");return{sph:t,cyl:n,axi:r,add:a}},he=function(e){return e&&Math.abs(parseFloat(e))>0},be=function(e){var t={lackPd:0,lackAxiR:0,lackAxiL:0};e.pd.toString().length<2&&(t.lackPd=1);var n=e.axiR,r=e.axiL;return e.cylR&&Math.abs(parseFloat(e.cylR))>0&&(n?(""!==n&&null!=n||(t.lackAxiR=1),isNaN(n)&&(t.lackAxiR=1)):t.lackAxiR=1),e.cylL&&Math.abs(parseFloat(e.cylL))>0&&(r?(""!==r&&null!=r||(t.lackAxiL=1),isNaN(r)&&(t.lackAxiL=1)):t.lackAxiL=1),t},ye=function(e){var t=e.value,n=e.onChange,a=e.selectType,o=void 0===a?0:a,l=e.positiveNegative,c=void 0===l?"negative":l,s=e.placeholder,i=void 0===s?"请选择球镜":s,u=function(e,t){void 0===e&&(e="negative"),void 0===t&&(t=90);for(var n=[],r="negative"===e?"-":"+",a=0;a<t;a++){var o=r+(.25*a).toFixed(2);n.push({label:o,value:o})}return n}(c,[90,25,17][o]);return r.createElement(v.Z,{style:ve,value:t,onChange:n,placeholder:i},u.map((function(e){return r.createElement(fe,{key:e.value,value:e.value},e.label)})))},Ee=["取消 重新输入, 确认 直接提交!","取消 重新输入, 确认 直接提交!(删除散光光度)"],Ce=["未输入瞳距","未输入散光轴位","未输入瞳距和散光轴位"],Oe=function(e){var t=e.sourceDiopterObj,n=e.selectedHandle,a=e.cancelHandle,o=I.Z.useForm()[0],l=(0,r.useState)(!1),s=l[0],u=l[1],d=(0,r.useState)(1),m=d[0],p=d[1],f=(0,r.useState)("negative"),v=f[0],_=f[1],g=(0,r.useState)("negative"),h=g[0],b=g[1],y=(0,r.useState)(Ee[0]),E=y[0],C=y[1],O=(0,r.useState)(Ce[0]),S=O[0],k=O[1],x=(0,r.useState)(!1),j=x[0],P=x[1],R=(0,r.useRef)({diopter_l:"",diopter_r:"",pupillary_distance:""});(0,r.useEffect)((function(){P(!1);var e=ge(t.diopter_r),n=ge(t.diopter_l),r=e.add?e.add:n.add;r&&P(!0);var a={sphR:e.sph,cylR:e.cyl,axiR:e.axi,sphL:n.sph,cylL:n.cyl,axiL:n.axi,add:r,pd:t.pupillary_distance};o.setFieldsValue(a)}),[t]);var D=r.createElement(I.Z.Item,{label:"ADD",name:"add"},r.createElement(ye,{selectType:2,positiveNegative:"positive",placeholder:"请选择ADD"})),q=r.createElement(I.Z.Item,null,r.createElement(i.Z,{type:"link",onClick:function(){return P(!0)}},"ADD..."));return r.createElement("div",null,r.createElement("h6",null,"正负光度:  ",r.createElement(de.Group,{onChange:function(e){console.log(e.target.value),p(e.target.value);var t=_e[e.target.value];_(t[0]),b(t[1])},value:m},r.createElement(de,{value:1},"-/-"),r.createElement(de,{value:2},"-/+"),r.createElement(de,{value:3},"+/-"),r.createElement(de,{value:4},"+/+"))),r.createElement(H.Z,null),r.createElement(I.Z,Object.assign({form:o,name:"diopters-form",onFinish:function(e){var t,r,a,o;R.current=(r=(t=e).sphR?t.sphR:"",a=t.sphL?t.sphL:"",o=be(t),he(t.cylR)&&0===o.lackAxiR&&(r=(r=""===r?"-0.00":r)+" "+t.cylR+" * "+t.axiR),he(t.cylL)&&0===o.lackAxiR&&(a=(a=""===a?"-0.00":a)+" "+t.cylL+" * "+t.axiL),he(t.add)&&(r=r+" ADD:"+t.add,a=a+" ADD:"+t.add),{diopter_r:r,diopter_l:a,pupillary_distance:t.pd});var l=be(e),c=-1;if(l.lackPd>0||l.lackAxiR>0||l.lackAxiL>0){var s=l.lackPd>0,i=l.lackAxiR>0,d=l.lackAxiL>0;(c=(c=s?0:c)>-1?i||d?2:c:i||d?1:c)>-1&&(k(Ce[c]),C(0===c?Ee[0]:Ee[1]),u(!0))}else n(R.current)}},Z.Z.formCommonStyle.layoutForm),r.createElement(I.Z.Item,{label:"光度R"},r.createElement(I.Z.Item,{name:"sphR"},r.createElement(ye,{selectType:0,positiveNegative:v})),r.createElement(I.Z.Item,{name:"cylR"},r.createElement(ye,{selectType:1,positiveNegative:h,placeholder:"请选择柱镜"})),r.createElement(I.Z.Item,{name:"axiR"},r.createElement(me.Z,{min:1,max:180,style:{width:"8rem"},placeholder:"请输入轴位"}))),r.createElement(I.Z.Item,{label:"光度L"},r.createElement(I.Z.Item,{name:"sphL"},r.createElement(ye,{selectType:0,positiveNegative:v})),r.createElement(I.Z.Item,{name:"cylL"},r.createElement(ye,{selectType:1,positiveNegative:h,placeholder:"请选择柱镜"})),r.createElement(I.Z.Item,{name:"axiL"},r.createElement(me.Z,{min:1,max:180,style:{width:"8rem"},placeholder:"请输入轴位"}))),r.createElement(I.Z.Item,{label:"PD",name:"pd"},r.createElement(pe.Z,{placeholder:"请输入瞳距",style:{maxWidth:"10rem"}})),j?D:q,r.createElement(I.Z.Item,Z.Z.formCommonStyle.tailFormItemLayout,r.createElement(c.Z,null,r.createElement(i.Z,{type:"primary",htmlType:"submit"},"确定"),r.createElement(i.Z,{htmlType:"button",onClick:a},"取消")))),r.createElement(w.Z,{title:S,visible:s,onOk:function(){u(!1),n(R.current)},onCancel:function(){return u(!1)},okText:"确认",cancelText:"取消"},r.createElement("p",null,E)))};Oe.defaultProps={sourceDiopterObj:{diopter_l:"",diopter_r:"",pupillary_distance:""},selectedHandle:function(e){return console.log(e)},cancelHandle:function(){return console.log("Cancel select diopters...")}};var Ze=function(e){var t=e.sourceDiopterObj,n=e.modalState,a=e.setModalState,o=e.selectHandle;return r.createElement(r.Fragment,null,r.createElement(w.Z,{visible:n,title:"选择光度",closable:!1,footer:null},r.createElement(Oe,{sourceDiopterObj:t,selectedHandle:o,cancelHandle:function(){return a(!1)}})))};Ze.defaultProps={sourceDiopterObj:{diopter_l:"",diopter_r:"",pupillary_distance:""},modalState:!1,setModalState:function(e){return console.log(e)},selectCustomerHandle:function(e){console.log(e)},clickCreatedCustomerHandle:function(e){console.log(e)}};var Se=n(98662),ke=n(47696),xe=n(15169),je=(n(88175),ke.Z.RangePicker),Pe=["id","input_staff_id","latest_modify_staff_id","customer_id","customer_name","product_title","diopter_r","diopter_l","pupillary_distance","receive_address","products_quantity","purchase_amount","products_cost","sale_platform","order_state","pay_table_id","pay_platform","add_time","update_time","explains","explains_customer","has_print","image_cos_name1","image_cos_name2","image_cos_name3","image_cos_name4","image_cos_name5"],Re=["id","input_staff_id","latest_modify_staff_id","customer_name","group_purchase_commander_id","group_purchase_commander_name","diopter_r","diopter_l","pupillary_distance","receive_address","pay_table_id","add_time","update_time","has_print","image_cos_name1","image_cos_name2","image_cos_name3","image_cos_name4","image_cos_name5"],De=["input_staff_id","latest_modify_staff_id","customer_id","group_purchase_commander_id","group_purchase_commander_name","receive_address","image_cos_name1","image_cos_name2","image_cos_name3","image_cos_name4","image_cos_name5"],we={id:"订单ID",input_staff_id:"订单创建管理员",latest_modify_staff_id:"最后修改管理员",customer_id:"顾客ID",customer_name:"顾客",group_purchase_commander_id:"团购团长ID",group_purchase_commander_name:"团购团长",product_title:"商品标题",diopter_r:"光度R",diopter_l:"光度L",pupillary_distance:"瞳距(PD)",receive_address:"收货地址",products_quantity:"商品数量",purchase_amount:"订单金额",products_cost:"商品成本",sale_platform:"销售平台",order_state:"订单状态",pay_table_id:"支付表ID",pay_platform:"支付方式",add_time:"新建时间",update_time:"更新时间",explains:"商家备注",explains_customer:"顾客留言",has_print:"打印状态",image_cos_name1:"订单图片1",image_cos_name2:"订单图片2",image_cos_name3:"订单图片3",image_cos_name4:"订单图片4",image_cos_name5:"订单图片5",range_add_time:"日期",add_time_start:"开始时间",add_time_end:"结束时间"},He=r.createElement(je,null),qe=r.createElement(ke.Z,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"}),Le={has_print:r.createElement(xe.A,{options:[{value:0,label:"未打印"},{value:1,label:"已打印"},{value:2,label:"全部"}]}),sale_platform:r.createElement(xe.A,{options:[{value:0,label:"未知或未输入"},{value:1,label:"门店"},{value:2,label:"淘宝"},{value:3,label:"小程序"},{value:4,label:"微信-方灵芝"},{value:5,label:"微信-展望眼镜"}]}),order_state:r.createElement(xe.A,{options:[{value:0,label:"订单交易完成"},{value:1,label:"未付款"},{value:2,label:"定制中"},{value:3,label:"已发货"},{value:4,label:"售后处理中"}]}),pay_platform:r.createElement(xe.A,{options:[{value:0,label:"未知"},{value:1,label:"微信支付"},{value:2,label:"支付宝支付"},{value:3,label:"刷卡"},{value:4,label:"现金"}]}),range_add_time:He,add_time_start:qe,add_time_end:qe},Ie=function(e){return{customer_name:{buttonTips:"选择顾客",clickMethod:function(){return e(1)}},pupillary_distance:{buttonTips:"选择光度瞳距",clickMethod:function(){return e(3)}}}},Ae=["id","customer_name","sale_platform","order_state","range_add_time","has_print"],Ne={id:0,input_staff_id:0,latest_modify_staff_id:0,customer_id:0,customer_name:"",group_purchase_commander_id:0,product_title:"",diopter_r:"",diopter_l:"",pupillary_distance:"",receive_address:"",products_quantity:0,purchase_amount:0,products_cost:0,sale_platform:0,order_state:0,pay_table_id:0,pay_platform:0,add_time:"",update_time:"",explains:"",explains_customer:"",has_print:2,image_cos_name1:"",image_cos_name2:"",image_cos_name3:"",image_cos_name4:"",image_cos_name5:""},Fe=["image_cos_name"],Me=["records-admin/v1/purchaserecord","records-admin/v1/purchaserecordproducts","records-admin/v1/purchaserecorddeliveryaddress"],Te=function(e){var t=e.requestCount,n=e.reqParams,a=e.responseDataHandle,o=Me[0];return r.createElement(k.Z,{responseDataHandle:a,api:o,method:"get",reqParams:n,reqObject:{},requestCount:t.length})};Te.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var Ve=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,o=[].concat(Me)[0];return r.createElement(k.Z,{responseDataHandle:a,api:o,method:"post",reqParams:{},reqObject:n,requestCount:t})};Ve.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var Ke=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,o=e.id,l=[].concat(Me)[0]+"/"+o;return r.createElement(k.Z,{responseDataHandle:a,api:l,method:"put",reqParams:{},reqObject:n,requestCount:t})};Ke.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var Be=function(e){var t=e.requestCount,n=e.responseDataHandle,a=e.id,o=[].concat(Me)[0]+"/"+a;return r.createElement(k.Z,{responseDataHandle:n,api:o,method:"delete",reqParams:{},reqObject:{},requestCount:t})};Be.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var Ye=n(86257),Ue=["id","group_purchase_commander_id","group_purchase_commander_name","pay_table_id","add_time","update_time","input_staff_id","latest_modify_staff_id","customer_id","receive_address","explains_customer","image_cos_name1","image_cos_name2","image_cos_name3","image_cos_name4","image_cos_name5","has_print"],$e=function(e){var t=e.visible,n=e.setVisible,a=e.reloadListCount,o=e.setReloadListCount,l=(0,r.useRef)({}),c=(0,r.useRef)({createCount:0}),s=(0,r.useState)({diopter_l:"",diopter_r:"",pupillary_distance:""}),i=s[0],u=s[1],d=(0,r.useState)({}),m=d[0],p=d[1],f=(0,r.useState)(0),v=f[0],g=f[1],h=(0,r.useState)(0),b=h[0],y=h[1],E=(0,r.useRef)({}),C=(0,r.useRef)({}),O=(0,r.useState)(0),Z=O[0],S=O[1];(0,r.useEffect)((function(){t&&(l.current={},C.current={},c.current={createCount:c.current.createCount+1},g(v+1),u({diopter_l:"",diopter_r:"",pupillary_distance:""}))}),[t]);var k=function(){n(!1)};return r.createElement(r.Fragment,null,r.createElement(w.Z,{visible:t,title:"PurchaseRecords 新建",closable:!1,footer:null},r.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},r.createElement(Se.DX,{oldObj:c.current,maxImagesNum:5,imageKeyName:Fe[0],onChange:function(e){l.current=Object.assign({},e)}})),r.createElement(H.Z,null),r.createElement(Ye.y,{columns:Pe,disabledKeys:Re,notShowKeys:Ue,formKeyLabelObj:we,formKeySelectComponentsObj:Le,formKeysItemButtonObj:Ie(S),onFinish:function(e){var t=Object.assign({},e,l.current,{customer_id:C.current.id});delete t.customer_name,E.current=t,console.log(E.current),y(b+1)},cancelHandle:k,showDeleteButton:!1,updateFormObj:m,formInitialObj:Ne,initFormCount:v}),r.createElement(Ve,{requestCount:b,reqObject:E.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(k(),o(a+1)):_.ZP.error("网络错误...")}}),r.createElement(L,{modalState:1===Z,setModalState:S,selectCustomerHandle:function(e){console.log(e,e.name);var t=e.name;Object.keys(e).includes("wx_info")&&(t=t+"("+e.wx_info.wx_nickname+")"),C.current=e,p({customer_name:t}),S(!1)}}),r.createElement(Ze,{sourceDiopterObj:i,modalState:3===Z,setModalState:S,selectHandle:function(e){u(e),p(e),S(0)}})))};$e.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},reloadListCount:0,setReloadListCount:function(e){return console.log(e)}};var ze=$e,Ge=n(37011),We=["customer_name"],Xe=function(e){var t=e.visible,n=e.setVisible,a=e.queryHandle,o=(0,r.useRef)(0),l=(0,r.useState)(0),c=l[0],s=l[1],i=(0,r.useState)({}),u=i[0],d=i[1],m=(0,r.useState)(!1),p=m[0],f=m[1],v=function(){s(c+1),n(!1)};return r.createElement(r.Fragment,null,r.createElement(Ge.Z,{title:"销售记录查询",width:"100%",height:"400px",placement:"top",onClose:v,visible:t,bodyStyle:{paddingBottom:80},footer:null},r.createElement(Ye.y,{columns:Ae,disabledKeys:We,formKeyLabelObj:we,formKeySelectComponentsObj:Le,formKeysItemButtonObj:Ie(f),onFinish:function(e){var t=Object.assign({},e),n={},r=e.id?parseInt(e.id):0;if(r>0)n.id=r;else{o.current>0&&(n.customer_id=o.current);var l=t.sale_platform;l>0&&l<6&&(n.sale_platform=l);var c=t.order_state;c>0&&c<5&&(n.order_state=c);var s=t.range_add_time;Array.isArray(s)&&2===s.length&&(n.add_time_start=s[0].format("YYYY-MM-DD"),n.add_time_end=s[1].format("YYYY-MM-DD"));var i=t.has_print;0!==i&&1!==i||(n.has_print=i)}a(n),setTimeout((function(){v()}),50)},cancelHandle:function(){return n(!1)},showDeleteButton:!1,formInitialObj:Ne,initFormCount:c,updateFormObj:u})),r.createElement(L,{modalState:p,setModalState:f,selectCustomerHandle:function(e){console.log(e,e.name),o.current=e.id;var t=e.name;Object.keys(e).includes("wx_info")&&(t=t+"("+e.wx_info.wx_nickname+")"),d({customer_name:t}),f(!1)}}))};Xe.defaultProps={visible:!1,setVisible:function(e){console.log(e)},queryHandle:function(e){console.log(e)}};var Qe=Xe,Je=n(83123),et=n(45311),tt=function(e){var t=e.visible,n=e.setVisible,a=e.oldObj,o=e.successDeletedOrUpdated,l=(0,r.useState)(!1),c=l[0],s=l[1],i=(0,r.useRef)({}),u=(0,r.useState)({diopter_l:"",diopter_r:"",pupillary_distance:""}),d=u[0],m=u[1],p=(0,r.useState)({}),f=p[0],v=p[1],g=(0,r.useState)(0),h=g[0],b=g[1],y=(0,r.useState)(0),E=y[0],C=y[1],O=(0,r.useRef)({}),Z=(0,r.useState)(0),S=Z[0],k=Z[1],x=(0,r.useState)(0),j=x[0],P=x[1];(0,r.useEffect)((function(){t>0&&R()}),[t,a]);var R=function(){b(h+1);var e="",t=0;try{Object.keys(a).includes("customer_info")&&(e=(0,et.Q)(a.customer_info)),t=a.has_print?1:0}catch(r){console.error(r),console.log(a)}var n=Object.assign({},a,{customer_name:e,has_print:t});v(n),m({diopter_r:n.diopter_r,diopter_l:n.diopter_l,pupillary_distance:n.pupillary_distance})};return r.createElement(w.Z,{visible:t,title:"PurchaseRecords",closable:!1,footer:null},r.createElement(Je.Z,{spinning:c}),r.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},r.createElement(Se.DX,{maxImagesNum:5,imageKeyName:"image_cos_name",oldObj:a,onChange:function(e){i.current=e}})),r.createElement(H.Z,null),r.createElement(Ye.y,{columns:Pe,disabledKeys:Re,notShowKeys:De,formKeyLabelObj:we,formKeySelectComponentsObj:Le,formKeysItemButtonObj:Ie(P),onFinish:function(e){var t=1===e.has_print,n=Object.assign({},e,i.current,{customer_id:f.customer_id,has_print:t});console.log(n),s(!0),O.current=n,C(E+1)},cancelHandle:function(){return n(0)},showDeleteButton:!0,deleteHandle:function(){Object.keys(a).includes("id")&&a.id>0?(k(S+1),o({method:"delete",result:null})):_.ZP.warn("修改顾客后不能直接删除, 关闭并重新打开再删除")},updateFormObj:f,formInitialObj:{},initFormCount:h}),r.createElement(Ke,{requestCount:E,reqObject:O.current,responseDataHandle:function(e){s(!1),Object.keys(e).includes("code")&&1e3===e.code?(_.ZP.success("修改成功"),o({method:"update",result:e}),n(0)):_.ZP.error("网络错误...")},id:O.current.id}),r.createElement(Be,{requestCount:S,responseDataHandle:function(e){return n(0)},id:a.id}),r.createElement(L,{modalState:1===j,setModalState:P,selectCustomerHandle:function(e){console.log(e,e.name);var t=e.name;Object.keys(e).includes("wx_info")&&(t=t+"("+e.wx_info.wx_nickname+")"),v({customer_info:e,customer_id:e.id,customer_name:t}),P(!1)}}),r.createElement(Ze,{sourceDiopterObj:d,modalState:3===j,setModalState:P,selectHandle:function(e){m(e),v(e),P(0)}}))};tt.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var nt=tt,rt=n(96899),at=n(81917),ot=n(54975),lt=n(85971),ct=function(e){var t=e.initAreaList,n=e.selectedAreaHandle;return r.createElement(lt.AreaSelect,{onChange:function(e){console.log(e),n(e)},level:2,data:ot.pcaa,defaultArea:t})};ct.defaultProps={initAreaObj:[],selectedAreaHandle:function(e){return console.log(e)}};var st=["id","express_company_code","express_number"],it=[],ut=["password","id"],dt={id:"ID",express_company_code:"快递公司",express_number:"快递单号",add_time:"创建时间",update_time:"更新时间",explains:"说明"},mt=function(e){var t=e.value,n=void 0===t?"":t,a=e.onChange,o=void 0===a?function(e){return console.log(e)}:a,l=(0,r.useState)([]),c=l[0],s=l[1];return(0,r.useEffect)((function(){new Promise((function(e,t){(0,x.H)("kdniao-admin/v1/kdniaoexpresscompanycodes","get",{},{}).then((function(t){e(t)})).catch((function(e){console.log(e),t(e)}))})).then((function(e){for(var t=e.results,n=[],r=0;r<t.length;r++){var a=t[r];n.push({value:a.express_company_code,label:a.express_company_name})}s(n)})).catch((function(e){console.log(e),s([])}))}),[]),r.createElement(xe.A,{options:c,value:n,onChange:o})},pt={express_company_code:r.createElement(mt,null)},ft={password:[{required:!0,message:"Please input Password!"}]},vt=["pic"],_t=["delivery-address/v1/customerdeliveryaddress"],gt=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,o=e.id,l=[].concat(_t)[0]+"/"+o;return r.createElement(k.Z,{responseDataHandle:a,api:l,method:"put",reqParams:{},reqObject:n,requestCount:t})};gt.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var ht=function(e){var t=e.requestCount,n=e.responseDataHandle,a=e.id,o=[].concat(_t)[0]+"/"+a;return r.createElement(k.Z,{responseDataHandle:n,api:o,method:"delete",reqParams:{},reqObject:{},requestCount:t})};ht.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var bt=function(e){e.visible;var t=e.setVisible,n=e.oldObj,a=e.purchaseRecordId,o=e.customerId,l=(0,r.useState)([]),c=(l[0],l[1]),s=((0,r.useRef)({}),(0,r.useState)("")),i=(s[0],s[1],(0,r.useState)({})),u=i[0],d=i[1],m=(0,r.useState)(0),p=m[0],f=m[1],v=(0,r.useState)(0),g=v[0],h=(v[1],(0,r.useRef)({})),b=(0,r.useState)(0),y=b[0];b[1];(0,r.useEffect)((function(){E()}),[n]);var E=function(){f(p+1),d(Object.assign({},n));for(var e=[],t=vt[0],r=1;r<10;r++){var a=t+r,o=a+"_url",l=n[a],s=n[o];"string"==typeof l&&l.length>5&&e.push({cosNameKey:a,cosName:l,urlKey:o,url:s})}c(e)};return r.createElement(r.Fragment,null,r.createElement(H.Z,null),r.createElement(Ye.p,{columns:st,disabledKeys:it,notShowKeys:ut,formKeyLabelObj:dt,formKeySelectComponentsObj:pt,onFinish:function(e){var n=Object.assign({},e,{purchase_record_id:a,customer_id:o});console.log(n),h.current=n,t(!1)},cancelHandle:function(){return t(!1)},showDeleteButton:!1,deleteHandle:function(){console.log("Delete handle")},updateFormObj:u,formInitialObj:{},rulesObj:ft,initFormCount:p}),r.createElement(gt,{requestCount:g,reqObject:h.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(_.ZP.success("修改成功"),t(!1)):_.ZP.error("网络错误...")},id:u.id}),r.createElement(ht,{requestCount:y,responseDataHandle:function(e){return t(!1)},id:u.id}))};bt.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{},purchaseRecordId:0,customerId:0};var yt=bt,Et=function(e){e.selectButtonOnClick;var t=e.purchaseRecordId,n=void 0===t?0:t,a=e.customerId,o=void 0===a?0:a,l=((0,r.useRef)({page:0}),(0,r.useState)(1)),c=(l[0],l[1],(0,r.useState)(!1)),s=c[0],u=c[1],d=(0,r.useState)({}),m=d[0],p=(d[1],(0,r.useState)(!1));p[0],p[1];return r.createElement("div",null,r.createElement(ct,{selectedAreaHandle:function(e){console.log(e)}}),r.createElement(i.Z,{onClick:function(){return u(!0)},type:"link"},"发货"),s?r.createElement(yt,{visible:s,setVisible:u,oldObj:m,purchaseRecordId:n,customerId:o}):null)},Ct=n(21989),Ot=function(e){return Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5?2:1},Zt=function(e){var t=e.reloadListCount,n=(e.setReloadListCount,e.requestParams),a=e.purchaseRecordsChange,o=e.printerIndex,l=e.hasAllPrintCount,c=(0,r.useRef)(2),s=(0,r.useState)(2),i=s[0],u=s[1],d=(0,r.useState)(!1),m=d[0],p=d[1],f=(0,r.useRef)({page:0}),v=(0,r.useState)([]),_=v[0],g=v[1],h=(0,r.useState)(0),b=h[0],y=h[1],E=(0,r.useState)(""),C=E[0],O=E[1],Z=(0,r.useState)(!1),S=Z[0],k=Z[1],x=(0,r.useState)(0),j=x[0],P=x[1],R=(0,r.useState)({}),D=R[0],w=R[1];(0,r.useEffect)((function(){if(l>0){for(var e=[].concat(_),t=0;t<e.length;t++)e[t].has_print=!0;console.log(e),g(e),a(e)}}),[l]),(0,r.useEffect)((function(){f.current=Object.assign({},n),q()}),[t]),(0,r.useEffect)((function(){S&&!m&&c.current>1&&(k(!1),H())}),[S,c.current,m]);var H=function(){if(c.current>1&&!m){c.current=1,p(!0),u(1);var e=Number.isInteger(f.current.page)?f.current.page+1:1;f.current=Object.assign({},f.current,{page:e}),console.log(f.current);var t=b+1;console.log(t),y(t),O(C+"n")}else console.log("Error state: hasMore is ",c.current,", loading is ",m)},q=function(){f.current=Object.assign({},f.current,{page:0}),g([]),c.current=2,u(2),p(!1),k(!0)},L=r.createElement(Et,null);return r.createElement("div",null,r.createElement(Ct.v,{visible:j}),r.createElement(rt.g,{purchaseRecordsList:_,loadMore:H,hasMore:2===i,infoBottonTips:"详情编辑",infoBottonClick:function(e,t){var n=Object.assign({},e);console.log(n,t),w(n),P(1)},deliverComponent:L,printerIndex:o,successPrintCurrentRecordHandle:function(e,t){var n=[].concat(_);n[t]=e,g(n)}}),r.createElement(Te,{requestCount:C,reqParams:f.current,responseDataHandle:function(e){if(console.log("prqCount: ",C),console.log("resp process...",e),p(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")){var t=_.concat(e.results);g(t),a(t),c.current=Ot(e),u(Ot(e)),console.log(b)}else console.log("Error: get data...")}}),r.createElement(nt,{visible:1===j,setVisible:P,oldObj:D,successDeletedOrUpdated:function(e){var t="update"===e.method?1:0,n=e.result?e.result:D,r=function(e,t,n){void 0===n&&(n=1);var r=t.id?t.id:0;if(r>0)for(var a=[].concat(e),o=a.length-1;o>-1;o--)if(a[o].id===r){if(1===n)return a[o]=Object.assign({},a[o],t),console.log("update..."),a;if(0===n)return a.splice(o,1),console.log("delete..."),a}return console.log("not handle..."),e}(_,n,t);console.log(r),g(r)}}),r.createElement(at.n,{hasMore:2===c.current,onClick:H}))};Zt.defaultProps={reloadListCount:1,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},purchaseRecordsChange:function(e){return console.log(e)},printerIndex:-1,hasAllPrintCount:0};var St=Zt,kt=function(e){var t=e.paramsObj,n=void 0===t?{}:t,a=(0,r.useState)(""),o=a[0],l=a[1];(0,r.useEffect)((function(){c()}),[n]);var c=function(){var e="";Object.keys(n).forEach((function(t){if(Object.keys(we).includes(t)){var r=" "+we[t]+" = "+n[t]+";";e+=r}})),e.length>2?l(e="查询条件:"+e):(console.log("查询条件为空"),l(""))};return r.createElement("div",{style:{height:"auto",width:"100%",padding:"0.1rem 0.2rem"}},o.length>2?r.createElement("p",null,o):null)},xt=n(35641),jt=n(86040),Pt=function(){var e=(0,r.useState)([]),t=e[0],n=e[1],a=(0,r.useState)(-1),m=a[0],p=a[1],f=(0,r.useRef)({page:0}),v=(0,r.useState)(1),_=v[0],g=v[1],h=(0,r.useState)(!1),b=h[0],y=h[1],E=(0,r.useState)(!1),C=E[0],O=E[1],Z=(0,r.useState)(0),S=Z[0],k=Z[1],x=(0,r.useState)(0),j=x[0],P=x[1];(0,r.useEffect)((function(){(0,xt.Cc)()}),[]);var R=function(){f.current={page:0},g(_+1)};return r.createElement("div",null,r.createElement(o.Z,null,r.createElement(l.Z,{span:24},r.createElement(D,{onChange:p,purchaseRecordsList:t,setPurchaseRecordsList:n,hasAllPrintCount:S,setHasAllPrintCount:k}))),r.createElement(o.Z,null,r.createElement(l.Z,{span:14},r.createElement(c.Z,null,r.createElement("h4",null,"PurchaseRecords"),r.createElement(s.Z,{title:"刷新"},r.createElement(i.Z,{onClick:R,shape:"circle",icon:r.createElement(u.Z,null)})),r.createElement(s.Z,{title:"搜索"},r.createElement(i.Z,{onClick:function(){return y(!0)},shape:"circle",icon:r.createElement(d.Z,null)})))),r.createElement(l.Z,{span:10},r.createElement("div",{style:{width:"100%",height:"auto"}},r.createElement(i.Z,{style:{float:"right"},type:"link",onClick:function(){return P(1)}},"淘宝csv文件"),r.createElement(i.Z,{style:{float:"right"},type:"link",onClick:function(){return O(!0)}},"新建")))),r.createElement(o.Z,null,r.createElement(l.Z,{span:24},r.createElement(kt,{paramsObj:f.current}))),r.createElement(Qe,{visible:b,setVisible:y,queryHandle:function(e){f.current=Object.assign({},e),console.log(f.current),g(_+1),console.log("search...")}}),r.createElement(St,{reloadListCount:_,setReloadListCount:g,requestParams:f.current,purchaseRecordsChange:function(e){n(e)},printerIndex:m,hasAllPrintCount:S}),r.createElement(ze,{visible:C,setVisible:O,reloadListCount:_,setReloadListCount:g}),r.createElement(jt.d,{visible:j,setVisible:P,visibleNum:1,uploadedHandle:R}))},Rt=n(93751),Dt=function(){return r.createElement(a.Z,null,r.createElement(Rt.Z,{title:"Records"}),r.createElement(Pt,null))}}}]);
//# sourceMappingURL=component---src-pages-purchaserecords-js-408a7557067b68f0a702.js.map