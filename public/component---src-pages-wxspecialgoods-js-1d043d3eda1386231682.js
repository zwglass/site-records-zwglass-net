(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"2b33":function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),o=n.n(a),s=n("9qUX"),r=n("vrFN"),c=(n("f3/d"),n("tsqr")),l=n("BMrR"),i=n("kPKH"),u=n("zeV3"),d=n("3S7+"),m=n("2/Rp"),p=n("rLCj"),b=(n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("Z2Ku"),n("L9s1"),n("xfY5"),n("fN96"),n("91GP"),n("H+CO")),f=(n("VRzm"),n("Sm+g")),g=n("kO4H"),_=n("wd/R"),O=n.n(_),j=n("vpoQ"),h=["id","name","special_sale"],v=["id","name"],E=["image"],C={id:"ID",name:"品名",channel_id:"频道",categories:"分类",sort_order:"排序顺序",freight_template_id:"快递模版ID",freight_type:"快递类别",goods_brief:"商品简介",goods_number:"商品数量",goods_unit:"单位",has_done:"有现货",has_gallery:"已推广",is_delete:"已下架",is_index:"在序列",is_new:"是新品",is_on_sale:"已上架",keywords:"关键词",cost_price:"成本价",min_cost_price:"最低成本价",min_retail_price:"最低零售价",retail_price:"零售价",sell_volume:"销售数量",https_pic:"链接图",goods_desc:"详情页",list_pic:"主图",home_pic1:"主图1",home_pic2:"主图2",home_pic3:"主图3",home_pic4:"主图4",home_pic5:"主图5",home_pic6:"主图6",home_pic7:"主图7",home_pic8:"主图8",home_pic9:"主图9",goods_video:"商品视频",handle_staff_id:"操作员ID",add_time:"创建时间",update_time:"更新时间",explains:"说明",special_sale:"今日特价商品"},q={special_sale:o.a.createElement(j.a,{options:[{value:0,label:"否"},{value:1,label:"是"}]})},k=function(e){return{goods_id:{buttonTips:"选择商品",clickMethod:function(){return e(1)}}}},S={password:[{required:!0,message:"Please input Password!"}]},y=["home_pic"],D=["goods-admin/v1/specialgoods","goods-admin/v1/goods"],P=function(e,t,n,a){var s=[o.a.createElement(m.a,{onClick:function(){n(e),t(2)},type:"link"},"详情")];return a&&s.push(o.a.createElement(m.a,{onClick:function(){return a(e)},type:"link"},"选择")),s},H=function(e,t,n,a,s){var r=o.a.createElement("div",null,o.a.createElement("p",null,"商品ID: "+e.id),o.a.createElement("p",null,"是今日特价商品: "+(e.special_sale>0?"是":"否"))),c={id:e.id,actions:P(e,a,t,n),img:e.home_pic1_url,avatar:"",title:"商品标题:  "+e.name+";",content:r};return Object(b.b)(c,180)},w=function(e){var t=e.requestCount,n=e.reqParams,a=e.responseDataHandle,s=D[0];return o.a.createElement(f.a,{responseDataHandle:a,api:s,method:"get",reqParams:n,reqObject:{},requestCount:t})};w.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var L=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,s=e.id,r=[].concat(D)[0]+"/"+s;return o.a.createElement(f.a,{responseDataHandle:a,api:r,method:"put",reqParams:{},reqObject:n,requestCount:t})};L.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var I=function(e){var t=e.requestCount,n=e.responseDataHandle,a=e.id,s=[].concat(D)[0]+"/"+a;return o.a.createElement(f.a,{responseDataHandle:n,api:s,method:"delete",reqParams:{},reqObject:{},requestCount:t})};I.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var R=n("kLXV"),x=n("PArb"),V=n("g/of"),B=n("p8V/"),K=n("afJD"),G=function(e){var t=e.visible,n=e.setVisible,s=e.oldObj,r=e.reloadListCount,l=e.setReloadListCount,i=Object(a.useRef)({}),u=Object(a.useState)(0),d=u[0],m=u[1],p=Object(a.useRef)({}),b=Object(a.useState)(0),f=b[0],g=b[1],_=Object(a.useState)(0),j=_[0],D=_[1],P=Object(a.useState)({}),H=P[0],w=P[1];Object(a.useEffect)((function(){if(t>0){console.log(s),w({id:-1});var e=s.end_time?parseInt(s.end_time):0;e<1e10&&(e=parseInt(1e3*e));var n=O()(e);w(Object.assign({},s,{end_time:n}))}}),[t,s]);return o.a.createElement(R.a,{visible:2===t,title:"SpecialGoods",closable:!1,footer:null},o.a.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},o.a.createElement(V.b,{maxImagesNum:9,imageKeyName:y[0],oldObj:s,onChange:function(e){i.current=e,console.log(e)}})),o.a.createElement(x.a,null),o.a.createElement(B.a,{columns:h,disabledKeys:v,notShowKeys:E,formKeyLabelObj:C,formKeySelectComponentsObj:q,formKeysItemButtonObj:k(D),onFinish:function(e){var t=Object.assign({},e,i.current);console.log(t),t.end_time=parseInt(O.a.unix(t.end_time).unix()/1e3),console.log(t.end_time),p.current=t,m(d+1)},cancelHandle:function(){return n(0)},showDeleteButton:!0,deleteHandle:function(){g(f+1),l(r+1)},updateFormObj:H,rulesObj:S}),o.a.createElement(K.a,{modalState:1===j,setModalState:D,selectHandle:function(e){console.log(e),w({goods_id:e.id}),D(0)}}),o.a.createElement(L,{requestCount:d,reqObject:p.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(c.b.success("修改成功"),l(r+1),n(0)):c.b.error("网络错误...")},id:s.id}),o.a.createElement(I,{requestCount:f,responseDataHandle:function(e){return n(0)},id:s.id}))};G.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var N=G,M=n("ajnz"),z=function(e){var t=e.reloadListCount,n=e.setReloadListCount,s=e.requestParams,r=e.selectButtonOnClick,c=Object(a.useState)(0),l=c[0],i=c[1],u=Object(a.useState)(!0),d=u[0],m=u[1],p=Object(a.useState)(!1),f=p[0],g=p[1],_=Object(a.useState)(!1),O=_[0],j=_[1],h=Object(a.useRef)({page:0}),v=Object(a.useState)([]),E=v[0],C=v[1],q=Object(a.useState)(0),k=q[0],S=q[1],y=Object(a.useState)({}),D=y[0],P=y[1];Object(a.useEffect)((function(){d&&!f&&O&&(L(),j(!1))}),[O,d,f]),Object(a.useEffect)((function(){h.current=Object.assign({},s),I()}),[t]);var L=function(){if(d&&!f){g(!0),m(!1);var e=Number.isInteger(h.current.page)?h.current.page+1:1;h.current=Object.assign({},h.current,{page:e}),console.log(h.current),S(k+1)}else console.log("Error state: hasMore is ",d,", loading is ",f)},I=function(){h.current=Object.assign({},h.current,{page:0}),C([]),m(!0),g(!1),j(!0)};return o.a.createElement("div",null,o.a.createElement(w,{requestCount:k,reqParams:h.current,responseDataHandle:function(e){g(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")?(C(E.concat(e.results)),m(function(e){return!!(Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5)}(e))):console.log("Error: get data...")}}),o.a.createElement(b.a,{header:"SpecialGoods List",listData:E,visible:l,setVisible:i,randerItem:H,setSelectedItem:P,selectButtonOnClick:r}),o.a.createElement(N,{visible:l,setVisible:i,oldObj:D,reloadListCount:t,setReloadListCount:n}),o.a.createElement(M.a,{hasMore:d,onClick:L}))};z.defaultProps={reloadListCount:1,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},selectButtonOnClick:null};var F=z,J=function(e){var t=e.selectButtonOnClick,n=void 0===t?null:t,s=Object(a.useRef)({page:0}),r=Object(a.useState)(1),b=r[0],f=r[1],_=Object(a.useState)(0),O=_[0],j=_[1];return o.a.createElement("div",null,o.a.createElement(l.a,null,o.a.createElement(i.a,{span:14},o.a.createElement(u.b,null,o.a.createElement("h4",null,"SpecialGoods"),o.a.createElement(d.a,{title:"刷新"},o.a.createElement(m.a,{onClick:function(){s.current={page:0},f(b+1)},shape:"circle",icon:o.a.createElement(p.a,null)})))),o.a.createElement(i.a,{span:10},o.a.createElement("div",{style:{width:"100%",height:"auto"}},o.a.createElement(m.a,{style:{float:"right"},type:"link",onClick:function(){return j(9)}},"增加今日特价商品")))),o.a.createElement(F,{reloadListCount:b,setReloadListCount:f,requestParams:s.current,selectButtonOnClick:n}),o.a.createElement(K.a,{visible:O,setVisible:j,visibleNum:9,selectHandle:function(e){var t;j(0),(t=e.id,new Promise((function(e,n){var a=[].concat(D)[0]+"/"+t;Object(g.a)(a,"put",{},{special_sale:1}).then((function(t){1e3===t.code?e(t):n(t)})).catch((function(e){console.log(e),n(e)}))}))).then((function(e){console.log(e),c.b.success("设置 "+e.name+" 为今日特价商品成功!"),f(b+1)})).catch((function(t){console.log(t),c.b.error("设置今日特价商品(ID="+e.id+")失败...")}))}}))};t.default=function(){return o.a.createElement(s.a,null,o.a.createElement(r.a,{title:"WX SpecialGoods"}),o.a.createElement(J,null))}}}]);
//# sourceMappingURL=component---src-pages-wxspecialgoods-js-1d043d3eda1386231682.js.map