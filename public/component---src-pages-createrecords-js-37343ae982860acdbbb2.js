"use strict";(self.webpackChunkclient_admin_v102=self.webpackChunkclient_admin_v102||[]).push([[943],{8020:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var a=n(7294),l=n(262),r=n(4564),c=n(6411),m=n(1152),s=n(3765),i=n(3148),u=n(6452),o=n(2184),p=n(2889),d=n(3299),E=n(5146),Z=n(7371),f=n(8654),h=n(6858),v=n(1413),b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 256c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm192 200v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8zm-48 396H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm104.1-115.6c1.8-34.5 16.2-66.8 40.8-91.4 26.2-26.2 62-41 99.1-41 37.4 0 72.6 14.6 99.1 41 3.2 3.2 6.3 6.6 9.2 10.1L769.2 673a8 8 0 003 14.1l93.3 22.5c5 1.2 9.8-2.6 9.9-7.7l.6-95.4a8 8 0 00-12.9-6.4l-20.3 15.8C805.4 569.6 748.1 540 684 540c-109.9 0-199.6 86.9-204 195.7-.2 4.5 3.5 8.3 8 8.3h48.1c4.3 0 7.8-3.3 8-7.6zM880 744h-48.1c-4.3 0-7.8 3.3-8 7.6-1.8 34.5-16.2 66.8-40.8 91.4-26.2 26.2-62 41-99.1 41-37.4 0-72.6-14.6-99.1-41-3.2-3.2-6.3-6.6-9.2-10.1l23.1-17.9a8 8 0 00-3-14.1l-93.3-22.5c-5-1.2-9.8 2.6-9.9 7.7l-.6 95.4a8 8 0 0012.9 6.4l20.3-15.8C562.6 918.4 619.9 948 684 948c109.9 0 199.6-86.9 204-195.7.2-4.5-3.5-8.3-8-8.3z"}}]},name:"file-sync",theme:"outlined"},_=n(7041),g=function(e,t){return a.createElement(_.Z,(0,v.Z)((0,v.Z)({},e),{},{ref:t,icon:b}))};g.displayName="FileSyncOutlined";var y=a.forwardRef(g),C=n(1597),I=n(9726),x=n(3606),k=n(2210),F=n(5455),O=n(7864),j=function(e){var t=e.onChange,n=e.defaultFileList,l=e.fileList,r=e.multiple,c=e.maxFiles,m=(0,a.useState)(!0),s=m[0],i=m[1];(0,a.useEffect)((function(){l.length>=c?i(!1):i(!0)}),[l,c]);var u={action:F.Z.apiBaseUrl+"/files-handle/v1/uploadfiles",listType:"picture",defaultFileList:n,fileList:l,onChange:t,multiple:r,headers:{Authorization:(0,O.LP)()}};return a.createElement("div",null,a.createElement(x.Z,u,s?a.createElement(d.Z,null,a.createElement(k.Z,null)," Upload"):null))};j.defaultProps={multiple:!0,defaultFileList:[],fileList:[],maxFiles:5,onChange:function(e){console.log(e.file)}};var L=n(7047),q=n(8338),H=n(1903),S=n(5604),w=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle;return a.createElement(S.Z,{responseDataHandle:l,api:"records-admin/v1/purchaserecord",method:"post",reqParams:{},reqObject:n,requestCount:t})},z=c.Z.Option,R={customername:"",diopter_r:"",diopter_l:"",pupillary_distance:"",product_title:"",products_quantity:1,purchase_amount:0,sale_platform:0,order_state:0,receive_address:"",explains:"",upload:[]},V={layout:"horizontal",labelCol:{xs:{span:12},sm:{span:10}},wrapperCol:{xs:{span:12},sm:{span:14}}},P={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},B=function(){var e=(0,a.useState)(0),t=e[0],n=e[1],l=(0,a.useState)(!1),r=l[0],v=l[1],b=m.Z.useForm()[0],_=(0,a.useState)(!1),g=_[0],x=_[1],k=(0,a.useRef)({}),F=(0,a.useState)(0),O=F[0],j=F[1],S=(0,a.useRef)({}),B=(0,a.useRef)({}),D=function(e){k.current=e;var t=Object.keys(e),n=t.includes("name")?e.name:t.includes("wx_nickname")?e.wx_nickname:"";b.setFieldsValue({customername:n}),x(!1)},T=function(){return a.createElement(c.Z,{onChange:function(e){return b.setFieldsValue({order_state:Number(e)})},defaultValue:"0"},a.createElement(z,{value:"0"},"订单交易完成"),a.createElement(z,{value:"1"},"定制中"),a.createElement(z,{value:"2"},"已发货"))};return a.createElement("div",null,a.createElement(q.Z,{spinning:r}),a.createElement("h3",null,"新建销售记录"),a.createElement(L.XE,{onChange:function(e){B.current=e},cleanImagesCount:t}),a.createElement(m.Z,Object.assign({},V,{form:b,name:"createrecord",onFinish:function(e){var t=Object.assign({},e,B.current);delete t.customername;var n=Object.assign({},k.current);t.customer_id=Object.keys(n).includes("customer_id")?n.customer_id:n.id?n.id:0,console.log(t),S.current=t,v(!0),j(O+1)},initialValues:Object.assign({},R),scrollToFirstError:!0}),a.createElement(m.Z.Item,{label:"顾客",extra:"请选择或新建顾客"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(m.Z.Item,{name:"customername",noStyle:!0},a.createElement(o.Z,{disabled:!0}))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择或新建顾客"},a.createElement(d.Z,{type:"primary",onClick:function(){x(!0)},shape:"circle",icon:a.createElement(h.Z,null)}))))),a.createElement(m.Z.Item,{label:"光度 R",name:"diopter_r",extra:"选择或输入光度R"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(m.Z.Item,{name:"diopter_r",noStyle:!0},a.createElement(o.Z,null))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择光度"},a.createElement(d.Z,{type:"primary",shape:"circle",icon:a.createElement(y,null)}))))),a.createElement(m.Z.Item,{label:"光度 L",extra:"选择或输入光度L"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(m.Z.Item,{name:"diopter_l",noStyle:!0},a.createElement(o.Z,null))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择光度"},a.createElement(d.Z,{type:"primary",shape:"circle",icon:a.createElement(y,null)}))))),a.createElement(m.Z.Item,{label:"瞳距PD",name:"pupillary_distance"},a.createElement(o.Z,null)),a.createElement(m.Z.Item,{label:"商品名称",name:"product_title"},a.createElement(o.Z,null)),a.createElement(m.Z.Item,{label:"商品数量",name:"products_quantity"},a.createElement(E.Z,{min:0,max:1e3,formatter:function(e){return(""+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\s?|(,*)/g,"")}})),a.createElement(m.Z.Item,{label:"销售金额",name:"purchase_amount"},a.createElement(E.Z,{min:0,max:1e6,formatter:function(e){return("¥ "+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/¥\s?|(,*)/g,"")}})),a.createElement(m.Z.Item,{label:"销售平台",name:"sale_platform"},a.createElement(H.Z,null)),a.createElement(m.Z.Item,{label:"订单状态",name:"order_state"},a.createElement(T,null)),a.createElement(m.Z.Item,{label:"收货地址",name:"receive_address"},a.createElement(o.Z,null)),a.createElement(m.Z.Item,{label:"说明",name:"explains"},a.createElement(o.Z,null)),a.createElement(m.Z.Item,P,a.createElement(Z.Z,{size:"large"},a.createElement(d.Z,{type:"primary",htmlType:"submit"},"提交"),a.createElement(d.Z,{type:"dashed",onClick:function(){(0,C.navigate)("/")}},"取消")))),a.createElement(w,{requestCount:O,reqObject:S.current,responseDataHandle:function(e){console.log(e),v(!1),1e3===e.code?(b.setFieldsValue(Object.assign({},R)),n(t+1),s.ZP.success("创建订单成功!")):s.ZP.error("创建失败...")}}),a.createElement(f.Z,{visible:g,title:"选择顾客",footer:[a.createElement(d.Z,{key:"back",onClick:function(){x(!1)}},"取消")]},a.createElement(I.Z,{selectCustomerHandle:D,clickCreatedCustomerHandle:D})))},D=function(){return a.createElement(r.Z,null,a.createElement(l.Z,{title:"CreateRecord"}),a.createElement(B,null))}}}]);
//# sourceMappingURL=component---src-pages-createrecords-js-37343ae982860acdbbb2.js.map