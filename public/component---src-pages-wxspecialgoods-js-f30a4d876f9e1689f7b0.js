(self.webpackChunkzwglass_purchase_records=self.webpackChunkzwglass_purchase_records||[]).push([[3578],{96703:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var o=n(67294),s=n(93696),a=n(93751),r=n(40977),l=n(23148),c=n(56452),i=n(77371),u=n(90579),d=n(93299),m=n(30165),p=n(21565),f=n(33328),g=n(24274),_=n(73964),h=n.n(_),b=n(15169),E=["id","name","special_sale"],v=["id","name"],C=["image"],O={id:"ID",name:"品名",channel_id:"频道",categories:"分类",sort_order:"排序顺序",freight_template_id:"快递模版ID",freight_type:"快递类别",goods_brief:"商品简介",goods_number:"商品数量",goods_unit:"单位",has_done:"有现货",has_gallery:"已推广",is_delete:"已下架",is_index:"在序列",is_new:"是新品",is_on_sale:"已上架",keywords:"关键词",cost_price:"成本价",min_cost_price:"最低成本价",min_retail_price:"最低零售价",retail_price:"零售价",sell_volume:"销售数量",https_pic:"链接图",goods_desc:"详情页",list_pic:"主图",home_pic1:"主图1",home_pic2:"主图2",home_pic3:"主图3",home_pic4:"主图4",home_pic5:"主图5",home_pic6:"主图6",home_pic7:"主图7",home_pic8:"主图8",home_pic9:"主图9",goods_video:"商品视频",handle_staff_id:"操作员ID",add_time:"创建时间",update_time:"更新时间",explains:"说明",special_sale:"今日特价商品"},q={special_sale:o.createElement(b.A,{options:[{value:0,label:"否"},{value:1,label:"是"}]})},j=function(e){return{goods_id:{buttonTips:"选择商品",clickMethod:function(){return e(1)}}}},k={password:[{required:!0,message:"Please input Password!"}]},S=["home_pic"],y=["goods-admin/v1/specialgoods","goods-admin/v1/goods"],P=function(e,t,n,s){var a=[o.createElement(d.Z,{onClick:function(){n(e),t(2)},type:"link"},"详情")];return s&&a.push(o.createElement(d.Z,{onClick:function(){return s(e)},type:"link"},"选择")),a},Z=function(e,t,n,s,a){var r=o.createElement("div",null,o.createElement("p",null,"商品ID: "+e.id),o.createElement("p",null,"是今日特价商品: "+(e.special_sale>0?"是":"否"))),l={id:e.id,actions:P(e,s,t,n),img:e.home_pic1_url,avatar:"",title:"商品标题:  "+e.name+";",content:r};return(0,p.l)(l,180)},D=function(e){var t=e.requestCount,n=e.reqParams,s=e.responseDataHandle,a=y[0];return o.createElement(f.Z,{responseDataHandle:s,api:a,method:"get",reqParams:n,reqObject:{},requestCount:t})};D.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var H=function(e){var t=e.requestCount,n=e.reqObject,s=e.responseDataHandle,a=e.id,r=[].concat(y)[0]+"/"+a;return o.createElement(f.Z,{responseDataHandle:s,api:r,method:"put",reqParams:{},reqObject:n,requestCount:t})};H.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var w=function(e){var t=e.requestCount,n=e.responseDataHandle,s=e.id,a=[].concat(y)[0]+"/"+s;return o.createElement(f.Z,{responseDataHandle:n,api:a,method:"delete",reqParams:{},reqObject:{},requestCount:t})};w.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var I=n(94789),L=n(16306),x=n(98662),R=n(86257),B=n(42228),K=function(e){var t=e.visible,n=e.setVisible,s=e.oldObj,a=e.reloadListCount,l=e.setReloadListCount,c=(0,o.useRef)({}),i=(0,o.useState)(0),u=i[0],d=i[1],m=(0,o.useRef)({}),p=(0,o.useState)(0),f=p[0],g=p[1],_=(0,o.useState)(0),b=_[0],y=_[1],P=(0,o.useState)({}),Z=P[0],D=P[1];(0,o.useEffect)((function(){if(t>0){console.log(s),D({id:-1});var e=s.end_time?parseInt(s.end_time):0;e<1e10&&(e=parseInt(1e3*e));var n=h()(e);D(Object.assign({},s,{end_time:n}))}}),[t,s]);return o.createElement(I.Z,{visible:2===t,title:"SpecialGoods",closable:!1,footer:null},o.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},o.createElement(x.DX,{maxImagesNum:9,imageKeyName:S[0],oldObj:s,onChange:function(e){c.current=e,console.log(e)}})),o.createElement(L.Z,null),o.createElement(R.y,{columns:E,disabledKeys:v,notShowKeys:C,formKeyLabelObj:O,formKeySelectComponentsObj:q,formKeysItemButtonObj:j(y),onFinish:function(e){var t=Object.assign({},e,c.current);console.log(t),t.end_time=parseInt(h().unix(t.end_time).unix()/1e3),console.log(t.end_time),m.current=t,d(u+1)},cancelHandle:function(){return n(0)},showDeleteButton:!0,deleteHandle:function(){g(f+1),l(a+1)},updateFormObj:Z,rulesObj:k}),o.createElement(B.Y,{modalState:1===b,setModalState:y,selectHandle:function(e){console.log(e),D({goods_id:e.id}),y(0)}}),o.createElement(H,{requestCount:u,reqObject:m.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(r.ZP.success("修改成功"),l(a+1),n(0)):r.ZP.error("网络错误...")},id:s.id}),o.createElement(w,{requestCount:f,responseDataHandle:function(e){return n(0)},id:s.id}))};K.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var V=K,G=n(81917),M=function(e){var t=e.reloadListCount,n=e.setReloadListCount,s=e.requestParams,a=e.selectButtonOnClick,r=(0,o.useState)(0),l=r[0],c=r[1],i=(0,o.useState)(!0),u=i[0],d=i[1],m=(0,o.useState)(!1),f=m[0],g=m[1],_=(0,o.useState)(!1),h=_[0],b=_[1],E=(0,o.useRef)({page:0}),v=(0,o.useState)([]),C=v[0],O=v[1],q=(0,o.useState)(0),j=q[0],k=q[1],S=(0,o.useState)({}),y=S[0],P=S[1];(0,o.useEffect)((function(){u&&!f&&h&&(H(),b(!1))}),[h,u,f]),(0,o.useEffect)((function(){E.current=Object.assign({},s),w()}),[t]);var H=function(){if(u&&!f){g(!0),d(!1);var e=Number.isInteger(E.current.page)?E.current.page+1:1;E.current=Object.assign({},E.current,{page:e}),console.log(E.current),k(j+1)}else console.log("Error state: hasMore is ",u,", loading is ",f)},w=function(){E.current=Object.assign({},E.current,{page:0}),O([]),d(!0),g(!1),b(!0)};return o.createElement("div",null,o.createElement(D,{requestCount:j,reqParams:E.current,responseDataHandle:function(e){g(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")?(O(C.concat(e.results)),d(function(e){return!!(Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5)}(e))):console.log("Error: get data...")}}),o.createElement(p.S,{header:"SpecialGoods List",listData:C,visible:l,setVisible:c,randerItem:Z,setSelectedItem:P,selectButtonOnClick:a}),o.createElement(V,{visible:l,setVisible:c,oldObj:y,reloadListCount:t,setReloadListCount:n}),o.createElement(G.n,{hasMore:u,onClick:H}))};M.defaultProps={reloadListCount:1,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},selectButtonOnClick:null};var N=M,z=function(e){var t=e.selectButtonOnClick,n=void 0===t?null:t,s=(0,o.useRef)({page:0}),a=(0,o.useState)(1),p=a[0],f=a[1],_=(0,o.useState)(0),h=_[0],b=_[1];return o.createElement("div",null,o.createElement(l.Z,null,o.createElement(c.Z,{span:14},o.createElement(i.Z,null,o.createElement("h4",null,"SpecialGoods"),o.createElement(u.Z,{title:"刷新"},o.createElement(d.Z,{onClick:function(){s.current={page:0},f(p+1)},shape:"circle",icon:o.createElement(m.Z,null)})))),o.createElement(c.Z,{span:10},o.createElement("div",{style:{width:"100%",height:"auto"}},o.createElement(d.Z,{style:{float:"right"},type:"link",onClick:function(){return b(9)}},"增加今日特价商品")))),o.createElement(N,{reloadListCount:p,setReloadListCount:f,requestParams:s.current,selectButtonOnClick:n}),o.createElement(B.Y,{visible:h,setVisible:b,visibleNum:9,selectHandle:function(e){var t;b(0),(t=e.id,new Promise((function(e,n){var o=[].concat(y)[0]+"/"+t;(0,g.H)(o,"put",{},{special_sale:1}).then((function(t){1e3===t.code?e(t):n(t)})).catch((function(e){console.log(e),n(e)}))}))).then((function(e){console.log(e),r.ZP.success("设置 "+e.name+" 为今日特价商品成功!"),f(p+1)})).catch((function(t){console.log(t),r.ZP.error("设置今日特价商品(ID="+e.id+")失败...")}))}}))},A=function(){return o.createElement(s.Z,null,o.createElement(a.Z,{title:"WX SpecialGoods"}),o.createElement(z,null))}}}]);
//# sourceMappingURL=component---src-pages-wxspecialgoods-js-f30a4d876f9e1689f7b0.js.map