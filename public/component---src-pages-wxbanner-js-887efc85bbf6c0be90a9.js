"use strict";(self.webpackChunkclient_admin_v102=self.webpackChunkclient_admin_v102||[]).push([[2766],{5506:function(e,t,n){n.r(t),n.d(t,{default:function(){return ae}});var a=n(7294),l=n(4564),o=n(262),r=n(3148),s=n(6452),i=n(7371),u=n(2889),c=n(3299),d=n(4167),m=n(6858),f=n(3765),b=n(8654),p=n(6306),g=n(3964),E=n.n(g),v=n(7047),C=n(5604),_=n(6079),O=n(2486),h=n(3229),j=["id","enabled","end_time","goods_id","image","is_delete","link","link_type","sort_order","handle_staff_id","add_time","update_time","explains"],y=["id","image","goods_id","handle_staff_id","add_time","update_time"],q=["image","enabled","link","link_type","handle_staff_id"],S={id:"ID",enabled:"可编辑",end_time:"结束时间",goods_id:"商品ID",image:"图片",is_delete:"不显示",link:"链接",link_type:"链接类型",sort_order:"排序次序",handle_staff_id:"编辑人员",explains:"说明",add_time:"创建日期",update_time:"更新日期"},k=a.createElement(O.A,{options:[{value:0,label:"不可编辑"},{value:1,label:"可编辑"}]}),H=a.createElement(O.A,{options:[{value:0,label:"无效"},{value:1,label:"有效"}]}),Z=a.createElement(O.A,{options:[{value:0,label:"否"},{value:1,label:"是"}]}),D={enabled:k,end_time:a.createElement(_.Z,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"}),is_delete:Z,link_type:H},P=function(e){return{goods_id:{buttonTips:"选择商品",clickMethod:function(){return e(1)}}}},L=[],B={id:0,enabled:0,goods_id:0,end_time:"",is_delete:0,link:"",link_type:0,sort_order:0,explains:"",add_time:"",update_time:""},x={password:[{required:!0,message:"Please input Password!"}]},I=["image"],w=["banner-admin/v1/banners"],K=function(e,t,n,l){var o=[a.createElement(c.Z,{onClick:function(){n(e),t(2)},type:"link"},"详情")];return l&&o.push(a.createElement(c.Z,{onClick:function(){return l(e)},type:"link"},"选择")),o},R=function(e,t,n,a,l){var o={id:e.id,actions:K(e,a,t,n),img:e.image_url,avatar:"",title:"商品ID: "+e.goods_id,description:"结束时间: "+E().unix(e.end_time).format("YYYY-MM-DD HH:mm:ss"),content:e.explains};return(0,h.l)(o,180)},Y=function(e){var t=e.requestCount,n=e.reqParams,l=e.responseDataHandle,o=w[0];return a.createElement(C.Z,{responseDataHandle:l,api:o,method:"get",reqParams:n,reqObject:{},requestCount:t})};Y.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var F=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle,o=[].concat(w)[0];return a.createElement(C.Z,{responseDataHandle:l,api:o,method:"post",reqParams:{},reqObject:n,requestCount:t})};F.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var M=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle,o=e.id,r=[].concat(w)[0]+"/"+o;return a.createElement(C.Z,{responseDataHandle:l,api:r,method:"put",reqParams:{},reqObject:n,requestCount:t})};M.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var V=function(e){var t=e.requestCount,n=e.responseDataHandle,l=e.id,o=[].concat(w)[0]+"/"+l;return a.createElement(C.Z,{responseDataHandle:n,api:o,method:"delete",reqParams:{},reqObject:{},requestCount:t})};V.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var A=n(5071),N=n(4677),T=function(e){var t=e.visible,n=e.setVisible,l=e.reloadListCount,o=e.setReloadListCount,r=(0,a.useRef)({}),s=(0,a.useRef)({handleCount:0}),i=(0,a.useState)(0),u=i[0],c=i[1],d=(0,a.useState)(0),m=d[0],g=d[1],C=(0,a.useRef)({});(0,a.useEffect)((function(){c(u+1)}),[t]);var _=(0,a.useState)(0),O=_[0],h=_[1],k=(0,a.useState)({}),H=k[0],Z=k[1],L=function(){s.current={handleCount:s.current.handleCount+1},n(0)};return a.createElement(a.Fragment,null,a.createElement(b.Z,{visible:1===t,title:"Banners 新建",closable:!1,footer:null},a.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},a.createElement(v.DX,{oldObj:s.current,maxImagesNum:1,imageKeyName:I[0],onChange:function(e){r.current=Object.assign({},e),console.log(e)}})),a.createElement(p.Z,null),a.createElement(A.y,{columns:j,disabledKeys:y,notShowKeys:q,formKeyLabelObj:S,formKeySelectComponentsObj:D,formKeysItemButtonObj:P(h),onFinish:function(e){var t=Object.assign({},e,r.current);console.log(t),t.end_time=parseInt(E().unix(t.end_time).unix()/1e3),console.log(t.end_time),C.current=t,g(m+1)},cancelHandle:L,showDeleteButton:!1,formInitialObj:B,initFormCount:u,rulesObj:x,updateFormObj:H}),a.createElement(N.Y,{modalState:1===O,setModalState:h,selectHandle:function(e){console.log(e),Z({goods_id:e.id}),h(0)}}),a.createElement(F,{requestCount:m,reqObject:C.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(L(),o(l+1)):f.ZP.error("网络错误...")}})))};T.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},reloadListCount:0,setReloadListCount:function(e){return console.log(e)}};var X=T,W=n(8146),z=function(e){var t=e.visible,n=e.setVisible,l=e.queryHandle,o=(0,a.useState)(0),r=o[0],s=o[1],i=(0,a.useState)(0),u=i[0],c=i[1],d=(0,a.useState)({}),m=d[0],f=d[1],b=function(){s(r+1),n(!1)};return a.createElement(a.Fragment,null,a.createElement(W.Z,{title:"Banners查询",width:"100%",height:"400px",placement:"top",onClose:b,visible:t,bodyStyle:{paddingBottom:80},footer:null},a.createElement(A.y,{columns:L,formKeyLabelObj:S,formKeySelectComponentsObj:D,formKeysItemButtonObj:P(c),onFinish:function(e){var t=Object.assign({},e);console.log(t),l(t),setTimeout((function(){b()}),50)},cancelHandle:function(){return n(0)},showDeleteButton:!1,formInitialObj:B,initFormCount:r,updateFormObj:m})),a.createElement(N.Y,{modalState:1===u,setModalState:c,selectHandle:function(e){console.log(e),f({goods_id:e.id}),c(0)}}))};z.defaultProps={visible:!1,setVisible:function(e){console.log(e)},queryHandle:function(e){console.log(e)}};var G=z,J=function(e){var t=e.visible,n=e.setVisible,l=e.oldObj,o=e.reloadListCount,r=e.setReloadListCount,s=(0,a.useRef)({}),i=(0,a.useState)(0),u=i[0],c=i[1],d=(0,a.useRef)({}),m=(0,a.useState)(0),g=m[0],C=m[1],_=(0,a.useState)(0),O=_[0],h=_[1],k=(0,a.useState)({}),H=k[0],Z=k[1];(0,a.useEffect)((function(){if(t>0){console.log(l),Z({id:-1});var e=l.end_time?parseInt(l.end_time):0;e<1e10&&(e=parseInt(1e3*e));var n=E()(e);Z(Object.assign({},l,{end_time:n}))}}),[t,l]);return a.createElement(b.Z,{visible:2===t,title:"Banners",closable:!1,footer:null},a.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},a.createElement(v.DX,{maxImagesNum:1,imageKeyName:I[0],oldObj:l,onChange:function(e){s.current=e,console.log(e)}})),a.createElement(p.Z,null),a.createElement(A.y,{columns:j,disabledKeys:y,notShowKeys:q,formKeyLabelObj:S,formKeySelectComponentsObj:D,formKeysItemButtonObj:P(h),onFinish:function(e){var t=Object.assign({},e,s.current);console.log(t),t.end_time=parseInt(E().unix(t.end_time).unix()/1e3),console.log(t.end_time),d.current=t,c(u+1)},cancelHandle:function(){return n(0)},showDeleteButton:!0,deleteHandle:function(){C(g+1),r(o+1)},updateFormObj:H,rulesObj:x}),a.createElement(N.Y,{modalState:1===O,setModalState:h,selectHandle:function(e){console.log(e),Z({goods_id:e.id}),h(0)}}),a.createElement(M,{requestCount:u,reqObject:d.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(f.ZP.success("修改成功"),r(o+1),n(0)):f.ZP.error("网络错误...")},id:l.id}),a.createElement(V,{requestCount:g,responseDataHandle:function(e){return n(0)},id:l.id}))};J.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var Q=J,U=n(5765),$=function(e){var t=e.reloadListCount,n=e.setReloadListCount,l=e.requestParams,o=e.selectButtonOnClick,r=(0,a.useState)(0),s=r[0],i=r[1],u=(0,a.useState)(!0),c=u[0],d=u[1],m=(0,a.useState)(!1),f=m[0],b=m[1],p=(0,a.useState)(!1),g=p[0],E=p[1],v=(0,a.useRef)({page:0}),C=(0,a.useState)([]),_=C[0],O=C[1],j=(0,a.useState)(0),y=j[0],q=j[1],S=(0,a.useState)({}),k=S[0],H=S[1];(0,a.useEffect)((function(){c&&!f&&g&&(Z(),E(!1))}),[g,c,f]),(0,a.useEffect)((function(){v.current=Object.assign({},l),D()}),[t]);var Z=function(){if(c&&!f){b(!0),d(!1);var e=Number.isInteger(v.current.page)?v.current.page+1:1;v.current=Object.assign({},v.current,{page:e}),console.log(v.current),q(y+1)}else console.log("Error state: hasMore is ",c,", loading is ",f)},D=function(){v.current=Object.assign({},v.current,{page:0}),O([]),d(!0),b(!1),E(!0)};return a.createElement("div",null,a.createElement(Y,{requestCount:y,reqParams:v.current,responseDataHandle:function(e){b(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")?(O(_.concat(e.results)),d(function(e){return!!(Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5)}(e))):console.log("Error: get data...")}}),a.createElement(h.S,{header:"Banners List",listData:_,visible:s,setVisible:i,randerItem:R,setSelectedItem:H,selectButtonOnClick:o}),a.createElement(Q,{visible:s,setVisible:i,oldObj:k,reloadListCount:t,setReloadListCount:n}),a.createElement(U.n,{hasMore:c,onClick:Z}))};$.defaultProps={reloadListCount:1,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},selectButtonOnClick:null};var ee=$,te=function(e){var t=e.paramsObj,n=void 0===t?{}:t,l=(0,a.useState)(""),o=l[0],r=l[1];(0,a.useEffect)((function(){s()}),[n]);var s=function(){var e="";Object.keys(n).forEach((function(t){if(Object.keys(S).includes(t)){var a=" "+S[t]+" = "+n[t]+";";e+=a}})),e.length>2?r(e="查询条件:"+e):(console.log("查询条件为空"),r(""))};return a.createElement("div",{style:{height:"auto",width:"100%",padding:"0.1rem 0.2rem"}},o.length>2?a.createElement("p",null,o):null)},ne=function(e){var t=e.selectButtonOnClick,n=void 0===t?null:t,l=(0,a.useRef)({page:0}),o=(0,a.useState)(1),f=o[0],b=o[1],p=(0,a.useState)(!1),g=p[0],E=p[1],v=(0,a.useState)(!1),C=v[0],_=v[1];return a.createElement("div",null,a.createElement(r.Z,null,a.createElement(s.Z,{span:14},a.createElement(i.Z,null,a.createElement("h4",null,"Banners"),a.createElement(u.Z,{title:"刷新"},a.createElement(c.Z,{onClick:function(){l.current={page:0},b(f+1)},shape:"circle",icon:a.createElement(d.Z,null)})),a.createElement(u.Z,{title:"搜索"},a.createElement(c.Z,{onClick:function(){return E(!0)},shape:"circle",icon:a.createElement(m.Z,null)})))),a.createElement(s.Z,{span:10},a.createElement("div",{style:{width:"100%",height:"auto"}},a.createElement(c.Z,{style:{float:"right"},type:"link",onClick:function(){return _(1)}},"新建")))),a.createElement(r.Z,null,a.createElement(s.Z,{span:24},a.createElement(te,{paramsObj:l.current}))),a.createElement(G,{visible:g,setVisible:E,queryHandle:function(e){l.current=Object.assign({},e),b(f+1)}}),a.createElement(ee,{reloadListCount:f,setReloadListCount:b,requestParams:l.current,selectButtonOnClick:n}),a.createElement(X,{visible:C,setVisible:_,reloadListCount:f,setReloadListCount:b}))},ae=function(){return a.createElement(l.Z,null,a.createElement(o.Z,{title:"WX Banner"}),a.createElement(ne,null))}}}]);
//# sourceMappingURL=component---src-pages-wxbanner-js-887efc85bbf6c0be90a9.js.map