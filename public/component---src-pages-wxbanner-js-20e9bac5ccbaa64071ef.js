(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"/KCQ":function(e,t,n){"use strict";n.r(t);var a=n("q1tI"),l=n.n(a),o=n("9qUX"),r=n("vrFN"),s=(n("91GP"),n("BMrR")),i=n("kPKH"),c=n("zeV3"),u=n("3S7+"),d=n("2/Rp"),m=n("rLCj"),b=n("l+S1"),f=(n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("Z2Ku"),n("L9s1"),n("tsqr")),p=n("kLXV"),O=n("PArb"),g=n("wd/R"),j=n.n(g),E=n("g/of"),v=n("Sm+g"),C=n("+eQT"),_=n("vpoQ"),h=n("H+CO"),q=["id","enabled","end_time","goods_id","image","is_delete","link","link_type","sort_order","handle_staff_id","add_time","update_time","explains"],y=["id","image","goods_id","handle_staff_id","add_time","update_time"],S=["image","enabled","link","link_type","handle_staff_id"],k={id:"ID",enabled:"可编辑",end_time:"结束时间",goods_id:"商品ID",image:"图片",is_delete:"不显示",link:"链接",link_type:"链接类型",sort_order:"排序次序",handle_staff_id:"编辑人员",explains:"说明",add_time:"创建日期",update_time:"更新日期"},H=l.a.createElement(_.a,{options:[{value:0,label:"不可编辑"},{value:1,label:"可编辑"}]}),D=l.a.createElement(_.a,{options:[{value:0,label:"无效"},{value:1,label:"有效"}]}),L=l.a.createElement(_.a,{options:[{value:0,label:"否"},{value:1,label:"是"}]}),P={enabled:H,end_time:l.a.createElement(C.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"}),is_delete:L,link_type:D},w=function(e){return{goods_id:{buttonTips:"选择商品",clickMethod:function(){return e(1)}}}},B=[],R={id:0,enabled:0,goods_id:0,end_time:"",is_delete:0,link:"",link_type:0,sort_order:0,explains:"",add_time:"",update_time:""},x={password:[{required:!0,message:"Please input Password!"}]},I=["image"],K=["banner-admin/v1/banners"],V=function(e,t,n,a){var o=[l.a.createElement(d.a,{onClick:function(){n(e),t(2)},type:"link"},"详情")];return a&&o.push(l.a.createElement(d.a,{onClick:function(){return a(e)},type:"link"},"选择")),o},F=function(e,t,n,a,l){var o={id:e.id,actions:V(e,a,t,n),img:e.image_url,avatar:"",title:"商品ID: "+e.goods_id,description:"结束时间: "+j.a.unix(e.end_time).format("YYYY-MM-DD HH:mm:ss"),content:e.explains};return Object(h.b)(o,180)},M=function(e){var t=e.requestCount,n=e.reqParams,a=e.responseDataHandle,o=K[0];return l.a.createElement(v.a,{responseDataHandle:a,api:o,method:"get",reqParams:n,reqObject:{},requestCount:t})};M.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var Y=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,o=[].concat(K)[0];return l.a.createElement(v.a,{responseDataHandle:a,api:o,method:"post",reqParams:{},reqObject:n,requestCount:t})};Y.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var N=function(e){var t=e.requestCount,n=e.reqObject,a=e.responseDataHandle,o=e.id,r=[].concat(K)[0]+"/"+o;return l.a.createElement(v.a,{responseDataHandle:a,api:r,method:"put",reqParams:{},reqObject:n,requestCount:t})};N.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var T=function(e){var t=e.requestCount,n=e.responseDataHandle,a=e.id,o=[].concat(K)[0]+"/"+a;return l.a.createElement(v.a,{responseDataHandle:n,api:o,method:"delete",reqParams:{},reqObject:{},requestCount:t})};T.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var A=n("p8V/"),G=n("afJD"),J=function(e){var t=e.visible,n=e.setVisible,o=e.reloadListCount,r=e.setReloadListCount,s=Object(a.useRef)({}),i=Object(a.useRef)({handleCount:0}),c=Object(a.useState)(0),u=c[0],d=c[1],m=Object(a.useState)(0),b=m[0],g=m[1],v=Object(a.useRef)({});Object(a.useEffect)((function(){d(u+1)}),[t]);var C=Object(a.useState)(0),_=C[0],h=C[1],H=Object(a.useState)({}),D=H[0],L=H[1],B=function(){i.current={handleCount:i.current.handleCount+1},n(0)};return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{visible:1===t,title:"Banners 新建",closable:!1,footer:null},l.a.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},l.a.createElement(E.b,{oldObj:i.current,maxImagesNum:1,imageKeyName:I[0],onChange:function(e){s.current=Object.assign({},e),console.log(e)}})),l.a.createElement(O.a,null),l.a.createElement(A.a,{columns:q,disabledKeys:y,notShowKeys:S,formKeyLabelObj:k,formKeySelectComponentsObj:P,formKeysItemButtonObj:w(h),onFinish:function(e){var t=Object.assign({},e,s.current);console.log(t),t.end_time=parseInt(j.a.unix(t.end_time).unix()/1e3),console.log(t.end_time),v.current=t,g(b+1)},cancelHandle:B,showDeleteButton:!1,formInitialObj:R,initFormCount:u,rulesObj:x,updateFormObj:D}),l.a.createElement(G.a,{modalState:1===_,setModalState:h,selectHandle:function(e){console.log(e),L({goods_id:e.id}),h(0)}}),l.a.createElement(Y,{requestCount:b,reqObject:v.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(B(),r(o+1)):f.b.error("网络错误...")}})))};J.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},reloadListCount:0,setReloadListCount:function(e){return console.log(e)}};var Q=J,X=n("/wGt"),z=function(e){var t=e.visible,n=e.setVisible,o=e.queryHandle,r=Object(a.useState)(0),s=r[0],i=r[1],c=Object(a.useState)(0),u=c[0],d=c[1],m=Object(a.useState)({}),b=m[0],f=m[1],p=function(){i(s+1),n(!1)};return l.a.createElement(l.a.Fragment,null,l.a.createElement(X.a,{title:"Banners查询",width:"100%",height:"400px",placement:"top",onClose:p,visible:t,bodyStyle:{paddingBottom:80},footer:null},l.a.createElement(A.a,{columns:B,formKeyLabelObj:k,formKeySelectComponentsObj:P,formKeysItemButtonObj:w(d),onFinish:function(e){var t=Object.assign({},e);console.log(t),o(t),setTimeout((function(){p()}),50)},cancelHandle:function(){return n(0)},showDeleteButton:!1,formInitialObj:R,initFormCount:s,updateFormObj:b})),l.a.createElement(G.a,{modalState:1===u,setModalState:d,selectHandle:function(e){console.log(e),f({goods_id:e.id}),d(0)}}))};z.defaultProps={visible:!1,setVisible:function(e){console.log(e)},queryHandle:function(e){console.log(e)}};var W=z,U=(n("xfY5"),n("fN96"),function(e){var t=e.visible,n=e.setVisible,o=e.oldObj,r=e.reloadListCount,s=e.setReloadListCount,i=Object(a.useRef)({}),c=Object(a.useState)(0),u=c[0],d=c[1],m=Object(a.useRef)({}),b=Object(a.useState)(0),g=b[0],v=b[1],C=Object(a.useState)(0),_=C[0],h=C[1],H=Object(a.useState)({}),D=H[0],L=H[1];Object(a.useEffect)((function(){if(t>0){console.log(o),L({id:-1});var e=o.end_time?parseInt(o.end_time):0;e<1e10&&(e=parseInt(1e3*e));var n=j()(e);L(Object.assign({},o,{end_time:n}))}}),[t,o]);return l.a.createElement(p.a,{visible:2===t,title:"Banners",closable:!1,footer:null},l.a.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},l.a.createElement(E.b,{maxImagesNum:1,imageKeyName:I[0],oldObj:o,onChange:function(e){i.current=e,console.log(e)}})),l.a.createElement(O.a,null),l.a.createElement(A.a,{columns:q,disabledKeys:y,notShowKeys:S,formKeyLabelObj:k,formKeySelectComponentsObj:P,formKeysItemButtonObj:w(h),onFinish:function(e){var t=Object.assign({},e,i.current);console.log(t),t.end_time=parseInt(j.a.unix(t.end_time).unix()/1e3),console.log(t.end_time),m.current=t,d(u+1)},cancelHandle:function(){return n(0)},showDeleteButton:!0,deleteHandle:function(){v(g+1),s(r+1)},updateFormObj:D,rulesObj:x}),l.a.createElement(G.a,{modalState:1===_,setModalState:h,selectHandle:function(e){console.log(e),L({goods_id:e.id}),h(0)}}),l.a.createElement(N,{requestCount:u,reqObject:m.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(f.b.success("修改成功"),s(r+1),n(0)):f.b.error("网络错误...")},id:o.id}),l.a.createElement(T,{requestCount:g,responseDataHandle:function(e){return n(0)},id:o.id}))});U.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var Z=U,$=n("ajnz"),ee=function(e){var t=e.reloadListCount,n=e.setReloadListCount,o=e.requestParams,r=e.selectButtonOnClick,s=Object(a.useState)(0),i=s[0],c=s[1],u=Object(a.useState)(!0),d=u[0],m=u[1],b=Object(a.useState)(!1),f=b[0],p=b[1],O=Object(a.useState)(!1),g=O[0],j=O[1],E=Object(a.useRef)({page:0}),v=Object(a.useState)([]),C=v[0],_=v[1],q=Object(a.useState)(0),y=q[0],S=q[1],k=Object(a.useState)({}),H=k[0],D=k[1];Object(a.useEffect)((function(){d&&!f&&g&&(L(),j(!1))}),[g,d,f]),Object(a.useEffect)((function(){E.current=Object.assign({},o),P()}),[t]);var L=function(){if(d&&!f){p(!0),m(!1);var e=Number.isInteger(E.current.page)?E.current.page+1:1;E.current=Object.assign({},E.current,{page:e}),console.log(E.current),S(y+1)}else console.log("Error state: hasMore is ",d,", loading is ",f)},P=function(){E.current=Object.assign({},E.current,{page:0}),_([]),m(!0),p(!1),j(!0)};return l.a.createElement("div",null,l.a.createElement(M,{requestCount:y,reqParams:E.current,responseDataHandle:function(e){p(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")?(_(C.concat(e.results)),m(function(e){return!!(Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5)}(e))):console.log("Error: get data...")}}),l.a.createElement(h.a,{header:"Banners List",listData:C,visible:i,setVisible:c,randerItem:F,setSelectedItem:D,selectButtonOnClick:r}),l.a.createElement(Z,{visible:i,setVisible:c,oldObj:H,reloadListCount:t,setReloadListCount:n}),l.a.createElement($.a,{hasMore:d,onClick:L}))};ee.defaultProps={reloadListCount:1,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},selectButtonOnClick:null};var te=ee,ne=function(e){var t=e.paramsObj,n=void 0===t?{}:t,o=Object(a.useState)(""),r=o[0],s=o[1];Object(a.useEffect)((function(){i()}),[n]);var i=function(){var e="";Object.keys(n).forEach((function(t){if(Object.keys(k).includes(t)){var a=" "+k[t]+" = "+n[t]+";";e+=a}})),e.length>2?s(e="查询条件:"+e):(console.log("查询条件为空"),s(""))};return l.a.createElement("div",{style:{height:"auto",width:"100%",padding:"0.1rem 0.2rem"}},r.length>2?l.a.createElement("p",null,r):null)},ae=function(e){var t=e.selectButtonOnClick,n=void 0===t?null:t,o=Object(a.useRef)({page:0}),r=Object(a.useState)(1),f=r[0],p=r[1],O=Object(a.useState)(!1),g=O[0],j=O[1],E=Object(a.useState)(!1),v=E[0],C=E[1];return l.a.createElement("div",null,l.a.createElement(s.a,null,l.a.createElement(i.a,{span:14},l.a.createElement(c.b,null,l.a.createElement("h4",null,"Banners"),l.a.createElement(u.a,{title:"刷新"},l.a.createElement(d.a,{onClick:function(){o.current={page:0},p(f+1)},shape:"circle",icon:l.a.createElement(m.a,null)})),l.a.createElement(u.a,{title:"搜索"},l.a.createElement(d.a,{onClick:function(){return j(!0)},shape:"circle",icon:l.a.createElement(b.a,null)})))),l.a.createElement(i.a,{span:10},l.a.createElement("div",{style:{width:"100%",height:"auto"}},l.a.createElement(d.a,{style:{float:"right"},type:"link",onClick:function(){return C(1)}},"新建")))),l.a.createElement(s.a,null,l.a.createElement(i.a,{span:24},l.a.createElement(ne,{paramsObj:o.current}))),l.a.createElement(W,{visible:g,setVisible:j,queryHandle:function(e){o.current=Object.assign({},e),p(f+1)}}),l.a.createElement(te,{reloadListCount:f,setReloadListCount:p,requestParams:o.current,selectButtonOnClick:n}),l.a.createElement(Q,{visible:v,setVisible:C,reloadListCount:f,setReloadListCount:p}))};t.default=function(){return l.a.createElement(o.a,null,l.a.createElement(r.a,{title:"WX Banner"}),l.a.createElement(ae,null))}}}]);
//# sourceMappingURL=component---src-pages-wxbanner-js-20e9bac5ccbaa64071ef.js.map