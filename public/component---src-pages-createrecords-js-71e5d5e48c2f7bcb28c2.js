(self.webpackChunkzwglass_purchase_records=self.webpackChunkzwglass_purchase_records||[]).push([[943],{24856:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(67294),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},r=n(12112),c=function(e,t){return a.createElement(r.Z,Object.assign({},e,{ref:t,icon:l}))};c.displayName="SearchOutlined";var s=a.forwardRef(c)},25922:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var a=n(67294),l=n(93751),r=n(93696),c=n(27188),s=n(28130),m=n(40977),i=n(23148),u=n(56452),o=n(23796),p=n(90579),d=n(93299),E=n(65451),f=n(77371),Z=n(94789),h=n(24856),g={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M296 256c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm192 200v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8zm-48 396H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm104.1-115.6c1.8-34.5 16.2-66.8 40.8-91.4 26.2-26.2 62-41 99.1-41 37.4 0 72.6 14.6 99.1 41 3.2 3.2 6.3 6.6 9.2 10.1L769.2 673a8 8 0 003 14.1l93.3 22.5c5 1.2 9.8-2.6 9.9-7.7l.6-95.4a8 8 0 00-12.9-6.4l-20.3 15.8C805.4 569.6 748.1 540 684 540c-109.9 0-199.6 86.9-204 195.7-.2 4.5 3.5 8.3 8 8.3h48.1c4.3 0 7.8-3.3 8-7.6zM880 744h-48.1c-4.3 0-7.8 3.3-8 7.6-1.8 34.5-16.2 66.8-40.8 91.4-26.2 26.2-62 41-99.1 41-37.4 0-72.6-14.6-99.1-41-3.2-3.2-6.3-6.6-9.2-10.1l23.1-17.9a8 8 0 00-3-14.1l-93.3-22.5c-5-1.2-9.8 2.6-9.9 7.7l-.6 95.4a8 8 0 0012.9 6.4l20.3-15.8C562.6 918.4 619.9 948 684 948c109.9 0 199.6-86.9 204-195.7.2-4.5-3.5-8.3-8-8.3z"}}]},name:"file-sync",theme:"outlined"},v=n(12112),b=function(e,t){return a.createElement(v.Z,Object.assign({},e,{ref:t,icon:g}))};b.displayName="FileSyncOutlined";var C=a.forwardRef(b),_=n(25444),y=n(60842),x=n(75334),I=n(32210),O=n(48428),k=n(57926),j=function(e){var t=e.onChange,n=e.defaultFileList,l=e.fileList,r=e.multiple,c=e.maxFiles,s=(0,a.useState)(!0),m=s[0],i=s[1];(0,a.useEffect)((function(){l.length>=c?i(!1):i(!0)}),[l,c]);var u={action:O.Z.apiBaseUrl+"/files-handle/v1/uploadfiles",listType:"picture",defaultFileList:n,fileList:l,onChange:t,multiple:r,headers:{Authorization:(0,k.LP)()}};return a.createElement("div",null,a.createElement(x.Z,u,m?a.createElement(d.Z,null,a.createElement(I.Z,null)," Upload"):null))};j.defaultProps={multiple:!0,defaultFileList:[],fileList:[],maxFiles:5,onChange:function(e){console.log(e.file)}};var w=n(98662),z=n(25446),F=n(73856),L=n(33328),S=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle;return a.createElement(L.Z,{responseDataHandle:l,api:"records-admin/v1/purchaserecord",method:"post",reqParams:{},reqObject:n,requestCount:t})},q=c.Z.Option,H={customername:"",diopter_r:"",diopter_l:"",pupillary_distance:"",product_title:"",products_quantity:1,purchase_amount:0,sale_platform:0,order_state:0,receive_address:"",explains:"",upload:[]},R={layout:"horizontal",labelCol:{xs:{span:12},sm:{span:10}},wrapperCol:{xs:{span:12},sm:{span:14}}},V={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},P=function(){var e=(0,a.useState)(0),t=e[0],n=e[1],l=(0,a.useState)(!1),r=l[0],g=l[1],v=s.Z.useForm()[0],b=(0,a.useState)(!1),x=b[0],I=b[1],O=(0,a.useRef)({}),k=(0,a.useState)(0),j=k[0],L=k[1],P=(0,a.useRef)({}),B=(0,a.useRef)({}),D=function(e){O.current=e;var t=Object.keys(e),n=t.includes("name")?e.name:t.includes("wx_nickname")?e.wx_nickname:"";v.setFieldsValue({customername:n}),I(!1)},M=function(){return a.createElement(c.Z,{onChange:function(e){return v.setFieldsValue({order_state:Number(e)})},defaultValue:"0"},a.createElement(q,{value:"0"},"订单交易完成"),a.createElement(q,{value:"1"},"定制中"),a.createElement(q,{value:"2"},"已发货"))};return a.createElement("div",null,a.createElement(z.Z,{spinning:r}),a.createElement("h3",null,"新建销售记录"),a.createElement(w.XE,{onChange:function(e){B.current=e},cleanImagesCount:t}),a.createElement(s.Z,Object.assign({},R,{form:v,name:"createrecord",onFinish:function(e){var t=Object.assign({},e,B.current);delete t.customername;var n=Object.assign({},O.current);t.customer_id=Object.keys(n).includes("customer_id")?n.customer_id:n.id?n.id:0,console.log(t),P.current=t,g(!0),L(j+1)},initialValues:Object.assign({},H),scrollToFirstError:!0}),a.createElement(s.Z.Item,{label:"顾客",extra:"请选择或新建顾客"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(s.Z.Item,{name:"customername",noStyle:!0},a.createElement(o.Z,{disabled:!0}))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择或新建顾客"},a.createElement(d.Z,{type:"primary",onClick:function(){I(!0)},shape:"circle",icon:a.createElement(h.Z,null)}))))),a.createElement(s.Z.Item,{label:"光度 R",name:"diopter_r",extra:"选择或输入光度R"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(s.Z.Item,{name:"diopter_r",noStyle:!0},a.createElement(o.Z,null))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择光度"},a.createElement(d.Z,{type:"primary",shape:"circle",icon:a.createElement(C,null)}))))),a.createElement(s.Z.Item,{label:"光度 L",extra:"选择或输入光度L"},a.createElement(i.Z,{gutter:8},a.createElement(u.Z,{span:18},a.createElement(s.Z.Item,{name:"diopter_l",noStyle:!0},a.createElement(o.Z,null))),a.createElement(u.Z,{span:6},a.createElement(p.Z,{title:"选择光度"},a.createElement(d.Z,{type:"primary",shape:"circle",icon:a.createElement(C,null)}))))),a.createElement(s.Z.Item,{label:"瞳距PD",name:"pupillary_distance"},a.createElement(o.Z,null)),a.createElement(s.Z.Item,{label:"商品名称",name:"product_title"},a.createElement(o.Z,null)),a.createElement(s.Z.Item,{label:"商品数量",name:"products_quantity"},a.createElement(E.Z,{min:0,max:1e3,formatter:function(e){return(""+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\s?|(,*)/g,"")}})),a.createElement(s.Z.Item,{label:"销售金额",name:"purchase_amount"},a.createElement(E.Z,{min:0,max:1e6,formatter:function(e){return("¥ "+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/¥\s?|(,*)/g,"")}})),a.createElement(s.Z.Item,{label:"销售平台",name:"sale_platform"},a.createElement(F.Z,null)),a.createElement(s.Z.Item,{label:"订单状态",name:"order_state"},a.createElement(M,null)),a.createElement(s.Z.Item,{label:"收货地址",name:"receive_address"},a.createElement(o.Z,null)),a.createElement(s.Z.Item,{label:"说明",name:"explains"},a.createElement(o.Z,null)),a.createElement(s.Z.Item,V,a.createElement(f.Z,{size:"large"},a.createElement(d.Z,{type:"primary",htmlType:"submit"},"提交"),a.createElement(d.Z,{type:"dashed",onClick:function(){(0,_.navigate)("/")}},"取消")))),a.createElement(S,{requestCount:j,reqObject:P.current,responseDataHandle:function(e){console.log(e),g(!1),1e3===e.code?(v.setFieldsValue(Object.assign({},H)),n(t+1),m.ZP.success("创建订单成功!")):m.ZP.error("创建失败...")}}),a.createElement(Z.Z,{visible:x,title:"选择顾客",footer:[a.createElement(d.Z,{key:"back",onClick:function(){I(!1)}},"取消")]},a.createElement(y.Z,{selectCustomerHandle:D,clickCreatedCustomerHandle:D})))},B=function(){return a.createElement(r.Z,null,a.createElement(l.Z,{title:"CreateRecord"}),a.createElement(P,null))}}}]);
//# sourceMappingURL=component---src-pages-createrecords-js-71e5d5e48c2f7bcb28c2.js.map