"use strict";(self.webpackChunkclient_admin_v102=self.webpackChunkclient_admin_v102||[]).push([[9552],{4167:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(1413),l=n(7294),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},a=n(7041),s=function(e,t){return l.createElement(a.Z,(0,o.Z)((0,o.Z)({},e),{},{ref:t,icon:r}))};s.displayName="ReloadOutlined";var c=l.forwardRef(s)},5071:function(e,t,n){n.d(t,{p:function(){return g},y:function(){return b}});var o=n(7294),l=n(1152),r=n(2184),a=n(3299),s=n(7371),c=n(5455).Z.formCommonStyle,i=c.layoutForm,u=c.formItemLayout,d=c.tailFormItemLayout,m={width:260},f=function(e){var t=e.formKey,n=e.formKeyLabelObj,a=e.disabledKeys,s=e.updateFormObj,c=e.rulesObj,i=e.formKeySelectComponentsObj,d=e.passwordKeys,f=e.showLabelName,p=void 0===f||f,b=a.includes(t),g=n[t],y=s[t];return o.createElement(l.Z.Item,Object.assign({},u,{name:t,label:p?g:"",initialValue:y,rules:c[t]?c[t]:[]}),Object.keys(i).includes(t)?i[t]:d.includes(t)?o.createElement(r.Z.Password,{style:m}):o.createElement(r.Z,{style:m,placeholder:"请输入 "+g,disabled:b}))},p=function(e){var t=e.formKey,n=e.formKeyLabelObj,r=e.disabledKeys,s=e.updateFormObj,c=e.rulesObj,i=e.formKeySelectComponentsObj,d=e.passwordKeys,m=e.formKeysItemButtonObj,p=m[t].buttonTips,b=n[t];return o.createElement(l.Z.Item,Object.assign({},u,{label:b}),o.createElement(f,{formKey:t,formKeyLabelObj:n,disabledKeys:r,updateFormObj:s,rulesObj:c,formKeySelectComponentsObj:i,passwordKeys:d,showLabelName:!1}),o.createElement(a.Z,{type:"link",onClick:function(e){console.log(e);try{m[t].clickMethod()}catch(n){console.log(n)}}},p))},b=function(e){var t=e.columns,n=e.disabledKeys,r=e.notShowKeys,c=e.formKeyLabelObj,u=e.formKeySelectComponentsObj,m=e.formKeysItemButtonObj,b=e.onFinish,g=e.cancelHandle,y=e.deleteHandle,j=e.showDeleteButton,E=e.updateFormObj,O=e.formInitialObj,h=e.initFormCount,C=e.rulesObj,_=e.passwordKeys,v=l.Z.useForm()[0],K=(0,o.useState)(!1),Z=K[0],S=K[1];(0,o.useEffect)((function(){v.setFieldsValue(E),S(!1)}),[E]),(0,o.useEffect)((function(){h>0&&(v.setFieldsValue(O),S(!1))}),[h]);return o.createElement(l.Z,Object.assign({},i,{form:v,layout:"horizontal",onFinish:function(e){S(!0),b(e)},name:"adminer_info_edit"}),t.map((function(e,t){return r.includes(e)?null:Object.keys(m).includes(e)?o.createElement(p,{key:t.toString(),formKey:e,formKeyLabelObj:c,disabledKeys:n,updateFormObj:E,rulesObj:C,formKeySelectComponentsObj:u,passwordKeys:_,formKeysItemButtonObj:m}):o.createElement(f,{key:t.toString(),formKey:e,formKeyLabelObj:c,disabledKeys:n,updateFormObj:E,rulesObj:C,formKeySelectComponentsObj:u,passwordKeys:_})})),o.createElement(l.Z.Item,d,o.createElement(s.Z,null,o.createElement(a.Z,{loading:Z,disabled:Z,type:"primary",htmlType:"submit"},"提交"),o.createElement(a.Z,{onClick:g},"取消"),j?o.createElement(a.Z,{loading:Z,disabled:Z,onClick:function(){S(!0),y()}},"删除"):null)))};b.defaultProps={columns:[],disabledKeys:[],notShowKeys:[],formKeyLabelObj:{},formKeySelectComponentsObj:{},formKeysItemButtonObj:{},onFinish:function(e){console.log(e)},cancelHandle:function(){console.log("Cancel Handle")},deleteHandle:function(){console.log("Delete Handle")},showDeleteButton:!1,updateFormObj:{},formInitialObj:{},initFormCount:0,rulesObj:{},passwordKeys:[],getFieldsValueHandle:function(e){return console.log(e)}};var g=function(e){var t=e.columns,n=e.disabledKeys,c=e.notShowKeys,i=e.formKeyLabelObj,u=e.formKeySelectComponentsObj,d=e.onFinish,f=e.onFinishButtonTips,p=e.cancelHandle,b=e.showCancelButton,g=e.deleteHandle,y=e.showDeleteButton,j=e.updateFormObj,E=e.formInitialObj,O=e.initFormCount,h=e.rulesObj,C=e.passwordKeys,_=(e.getFieldsValueHandle,l.Z.useForm()[0]);(0,o.useEffect)((function(){_.setFieldsValue(j)}),[j]),(0,o.useEffect)((function(){_.setFieldsValue(E)}),[O]);var v=function(e){var t=e.formKey,a=n.includes(t),s=i[t],c=j[t];return o.createElement(l.Z.Item,{name:t,initialValue:c,rules:h[t]?h[t]:[]},Object.keys(u).includes(t)?u[t]:C.includes(t)?o.createElement(r.Z.Password,{style:m}):o.createElement(r.Z,{style:m,placeholder:"请输入 "+s,disabled:a}))};return o.createElement(l.Z,Object.assign({},{labelCol:{span:0},wrapperCol:{span:8}},{form:_,layout:"inline",onFinish:d,name:"adminer_info_edit"}),t.map((function(e,t){return c.includes(e)?null:o.createElement(v,{formKey:e,key:t.toString()})})),o.createElement(l.Z.Item,null,o.createElement(s.Z,null,o.createElement(a.Z,{type:"primary",htmlType:"submit"},f),b?o.createElement(a.Z,{onClick:p},"取消"):null,y?o.createElement(a.Z,{onClick:g},"删除"):null)))};g.defaultProps={columns:[],disabledKeys:[],notShowKeys:[],formKeyLabelObj:{},formKeySelectComponentsObj:{},onFinish:function(e){console.log(e)},onFinishButtonTips:"确定/修改",cancelHandle:function(){console.log("Cancel Handle")},showCancelButton:!1,deleteHandle:function(){console.log("Delete Handle")},showDeleteButton:!1,updateFormObj:{},formInitialObj:{},initFormCount:0,rulesObj:{},passwordKeys:[],getFieldsValueHandle:function(e){return console.log(e)}}},471:function(e,t,n){n.d(t,{Z:function(){return N}});var o=n(7294),l=n(3765),r=n(3148),a=n(6452),s=n(7371),c=n(2889),i=n(3299),u=n(3870),d=n(4167),m=n(1597),f=n(8654),p=n(6306),b=n(7047),g=n(5604),y=n(8102),j=["goods-admin/v1/goodscolorprice","goods-admin/v1/postgoodsstock"],E=function(e){var t=e.requestCount,n=e.reqParams,l=e.responseDataHandle,r=j[0];return o.createElement(g.Z,{responseDataHandle:l,api:r,method:"get",reqParams:n,reqObject:{},requestCount:t})};E.defaultProps={requestCount:0,reqParams:{},responseDataHandle:function(e){console.log(e)}};var O=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle,r=[].concat(j)[0];return o.createElement(g.Z,{responseDataHandle:l,api:r,method:"post",reqParams:{},reqObject:n,requestCount:t})};O.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)}};var h=function(e){var t=e.requestCount,n=e.reqObject,l=e.responseDataHandle,r=e.id,a=[].concat(j)[0]+"/"+r;return o.createElement(g.Z,{responseDataHandle:l,api:a,method:"put",reqParams:{},reqObject:n,requestCount:t})};h.defaultProps={requestCount:0,reqObject:{},responseDataHandle:function(e){console.log(e)},id:0};var C=function(e){var t=e.requestCount,n=e.responseDataHandle,l=e.id,r=[].concat(j)[0]+"/"+l;return o.createElement(g.Z,{responseDataHandle:n,api:r,method:"delete",reqParams:{},reqObject:{},requestCount:t})};C.defaultProps={requestCount:0,responseDataHandle:function(e){console.log(e)},id:0};var _=n(5071),v=n(3229),K=["id","goods","color_name","stock_num","retail_price","group_price","agent_price","cost_price","color_pic","handle_staff_id","add_time","update_time","explains"],Z=["id","goods","color_pic","handle_staff_id","add_time","update_time"],S=["id","color_pic","handle_staff_id"],H={id:"ID",goods:"商品ID",color_name:"颜色名称",stock_num:"库存数量",retail_price:"零售价格",group_price:"团购价格",agent_price:"代理价格",cost_price:"成本价",color_pic_url:"图片URL",color_pic:"图片cos",handle_staff_id:"操作员ID",add_time:"创建时间",update_time:"更新时间",explains:"说明"},w={},k={id:0,goods:0,color_name:"",stock_num:0,retail_price:0,group_price:0,agent_price:0,cost_price:0,color_pic_url:"",color_pic:"",handle_staff_id:0,add_time:"",update_time:"",explains:""},F="property_pic",q=function(e,t,n,l){var r=[o.createElement(i.Z,{onClick:function(){n(e),t(2)},type:"link"},"详情")];return l&&r.push(o.createElement(i.Z,{onClick:function(){l(e),t(0)},type:"link"},"选择")),r},L=function(e,t,n,l,r){var a=o.createElement("div",null,o.createElement("p",null,"库存数量: "+e.stock_num),o.createElement("p",null,"零售价: "+e.retail_price),o.createElement("p",null,"团购价: "+e.group_price),o.createElement("p",null,"代理价: "+e.agent_price),o.createElement("p",null,"成本: "+e.cost_price)),s={id:e.id,actions:q(e,l,t,n),img:e.property_pic_url,avatar:"",title:"颜色属性: "+e.color_name,description:"说明: "+e.explains,content:a};return(0,v.l)(s,120)},D=function(e){var t=e.visible,n=e.setVisible,r=e.reloadListCount,a=e.setReloadListCount,s=e.goodsId,c=(0,o.useRef)({}),i=(0,o.useRef)({createCount:0}),u=(0,o.useRef)({}),d=(0,o.useState)(0),m=d[0],g=d[1],y=(0,o.useState)(0),j=y[0],E=y[1],h=(0,o.useRef)({});(0,o.useEffect)((function(){var e=Object.assign({},k);e.goods=s,u.current=e,g(m+1)}),[s]);var C=function(){c.current={},i.current={createCount:i.current.createCount+1},g(m+1),n(!1)};return o.createElement(o.Fragment,null,o.createElement(f.Z,{visible:t,title:"ColorPrice 新建",closable:!1,footer:null},o.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},o.createElement(b.DX,{oldObj:i.current,imageKeyName:F,onChange:function(e){c.current=Object.assign({},e)}})),o.createElement(p.Z,null),o.createElement(_.y,{columns:K,disabledKeys:Z,notShowKeys:S,formKeyLabelObj:H,formKeySelectComponentsObj:w,onFinish:function(e){var t=Object.assign({},e,c.current);h.current=t,E(j+1)},cancelHandle:C,showDeleteButton:!1,formInitialObj:u.current,initFormCount:m}),o.createElement(O,{requestCount:j,reqObject:h.current,responseDataHandle:function(e){console.log(e),Object.keys(e).includes("code")&&1e3===e.code?(C(),a(r+1)):l.ZP.error("网络错误...")}})))};D.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},reloadListCount:0,setReloadListCount:function(e){return console.log(e)},goodsId:0};var P=D,I=function(e){var t=e.visible,n=e.setVisible,r=e.oldObj,a=e.reloadListCount,s=e.setReloadListCount,c=(0,o.useRef)({}),i=(0,o.useState)({}),u=i[0],d=i[1],m=(0,o.useState)(0),g=m[0],y=m[1],j=(0,o.useState)(0),E=j[0],O=j[1],v=(0,o.useRef)({}),k=(0,o.useState)(0),q=k[0],L=k[1];(0,o.useEffect)((function(){D()}),[t,r]);var D=function(){y(g+1),d(Object.assign({},r));for(var e=[],t=1;t<10;t++){var n="home_pic"+t,o=n+"_url",l=r[n],a=r[o];"string"==typeof l&&l.length>5&&e.push({cosNameKey:n,cosName:l,urlKey:o,url:a})}};return o.createElement(f.Z,{visible:2===t,title:"ColorPrice",closable:!1,footer:null},o.createElement("div",{style:{width:"100%",height:"auto",textAlign:"center"}},o.createElement(b.DX,{maxImagesNum:1,imageKeyName:F,oldObj:r,onChange:function(e){c.current=e,console.log(c.current)}})),o.createElement(p.Z,null),o.createElement(_.y,{columns:K,disabledKeys:Z,notShowKeys:S,formKeyLabelObj:H,formKeySelectComponentsObj:w,onFinish:function(e){var t=Object.assign({},e,c.current);console.log(t),v.current=t,O(E+1)},cancelHandle:function(){return n(!1)},showDeleteButton:!0,deleteHandle:function(){L(q+1),s(a+1)},updateFormObj:u,formInitialObj:{},initFormCount:g}),o.createElement(h,{requestCount:E,reqObject:v.current,responseDataHandle:function(e){Object.keys(e).includes("code")&&1e3===e.code?(l.ZP.success("修改成功"),s(a+1),n(0)):l.ZP.error("网络错误...")},id:u.id}),o.createElement(C,{requestCount:q,responseDataHandle:function(e){return n(!1)},id:u.id}))};I.defaultProps={visible:!1,setVisible:function(e){return console.log(e)},oldObj:{}};var R=I,B=["goods-admin/v1/goods"],V=function(e){var t=e.reloadListCount,n=e.setReloadListCount,l=e.requestParams,r=e.selectHandle,a=(0,o.useState)(0),s=a[0],c=a[1],i=(0,o.useState)(!0),u=i[0],d=i[1],m=(0,o.useState)(!1),f=m[0],p=m[1],b=(0,o.useState)(!1),g=b[0],j=b[1],O=(0,o.useRef)({page:1}),h=(0,o.useState)([]),C=h[0],_=h[1],K=(0,o.useState)(0),Z=K[0],S=K[1],H=(0,o.useState)({}),w=H[0],k=H[1];(0,o.useEffect)((function(){_([]),p(!1),d(!0),O.current=Object.assign({},l,{page:l.page+1}),j(!0)}),[t]),(0,o.useEffect)((function(){u&&!f&&g&&(j(!1),F())}),[u,f,g]);var F=function(){l.goods&&l.goods>0&&u&&!f?(d(!1),S(Z+1),p(!0)):console.log("Error state: hasMore is ",u,", loading is ",f)},q=function(e,t){void 0===t&&(t=!0);for(var n="retail_price",o=0,l=0;l<e.length;l++){var r=e[l],a=r[n]?r[n]:0;0===o&&(o=a),t?o>a&&a>0&&(o=a):o<a&&(o=a)}return o};return o.createElement("div",null,o.createElement(E,{requestCount:Z,reqParams:O.current,responseDataHandle:function(e){if(p(!1),Object.keys(e).includes("code")&&1e3===e.code&&Object.keys(e).includes("results")){_(C.concat(e.results)),d(function(e){return!!(Object.keys(e).includes("next")&&"string"==typeof e.next&&e.next.length>5)}(e));var t=e.results;if(t.length>0){console.log(t);var n=q(t),o=q(t,!1),l=function(e){for(var t=0,n=0;n<e.length;n++){var o=e[n];t+=o.stock_num>0?o.stock_num:0}return t}(t);console.log(n,o,t[0].goods),function(e,t,n,o){void 0===o&&(o=0);var l=B[0]+"/"+o,r={goods_number:n,min_retail_price:e,retail_price:t};return new Promise((function(e,t){o>0?(0,y.H)(l,"put",{},r).then((function(t){e(t)})).catch((function(e){t(e)})):t("Argument goodsId must..., ",o)}))}(n,o,l,t[0].goods).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}}else console.log("Error: get data...")}}),o.createElement(v.S,{header:"ColorPrice",listData:C,visible:s,setVisible:c,randerItem:L,setSelectedItem:k,selectButtonOnClick:r}),o.createElement(R,{visible:s,setVisible:c,oldObj:w,reloadListCount:t,setReloadListCount:n}))};V.defaultProps={reloadListCount:0,setReloadListCount:function(e){console.log(e)},requestParams:{page:0},selectHandle:null};var x=V,N=function(e){var t=e.location,n=(0,o.useState)(0),f=n[0],p=n[1],b=(0,o.useRef)({page:0}),g=(0,o.useState)(""),y=g[0],j=g[1],E=(0,o.useState)(0),O=E[0],h=E[1],C=(0,o.useState)(!1),_=C[0],v=C[1],K=(0,o.useState)(null),Z=K[0],S=K[1],H=(0,o.useState)(null),w=H[0],k=(H[1],function(){f&&f>0?(b.current={page:0,goods:f},h(O+1),console.log("init search 00 ...")):console.log("No goods...")});return(0,o.useEffect)((function(){try{console.log(t.state.goodsobj),p(t.state.goodsobj.id),j(t.state.goodsobj.name),S(t.state.selectHandle?t.state.selectHandle:null),console.log(t.state)}catch(e){console.log(e),l.ZP.error("Error: 请重新选择产品...")}}),[t.state]),(0,o.useEffect)((function(){k()}),[f]),o.createElement("div",null,o.createElement(r.Z,null,o.createElement(a.Z,{span:14},o.createElement("div",{style:{width:"100%",height:"auto",padding:"0.1rem 0.5rem"}},o.createElement(s.Z,{size:"large"},w?null:o.createElement(c.Z,{title:"返回"},o.createElement(m.Link,{to:"/wxgoods"},o.createElement(u.Z,null))),o.createElement("h4",null,"ColorPrice"),o.createElement(c.Z,{title:"刷新"},o.createElement(i.Z,{onClick:k,shape:"circle",icon:o.createElement(d.Z,null)}))))),o.createElement(a.Z,{span:10},o.createElement("div",{style:{width:"100%",height:"auto"}},o.createElement(i.Z,{style:{float:"right"},type:"link",onClick:function(){return v(!0)}},"新建")))),o.createElement(r.Z,{style:{margin:"1rem 0.2rem"}},o.createElement("h6",null,"商品标题: ",y)),o.createElement(x,{reloadListCount:O,setReloadListCount:h,requestParams:b.current,selectHandle:Z}),o.createElement(P,{visible:_,setVisible:v,reloadListCount:O,setReloadListCount:h,goodsId:f}))}}}]);
//# sourceMappingURL=c9690abbd4e2f8582167eb53d739858e76c6dee9-b8b9102e0fec38268b31.js.map